(()=>{"use strict";const e=function(e,t){let n=0,r=!1;return{hit:function(){return n+=1,n},getHits:function(){return n},isSunk:function(){return n==e&&(r=!0),r},length:e,shipName:t}},t=function(){let t=function(){let e=[],t=[],n=[],r=[],i=[];function o(e,t){return 10*e+t}function a(e,t,n,i){let a=o(e,t);if("Horizontal"==i)for(let e=0;e<n.length;e++)if(r.includes(a+e))return!1;if("Vertical"==i)for(let e=0;e<n.length;e++)if(r.includes(a+10*e))return!1;return!("Horizontal"==i&&t+n.length>10||"Vertical"==i&&e+n.length>10)}return{createBoard:function(){for(let t=0;t<10;t++)for(let n=0;n<10;n++){let r={coordinates:void 0,name:void 0};r.coordinates=[t,n],r.name=null,e.push(r)}return e},getBoard:function(){return e},checkValidity:a,placeShip:function(t,n,s,c){if("Horizontal"==c&&a(t,n,s,c)){let i=o(t,n);for(let t=0;t<s.length;t++)e[i+t].name=s.shipName,r.push(i+t)}if("Vertical"==c&&a(t,n,s,c)){let i=o(t,n);for(let t=0;t<s.length;t++)e[i+10*t].name=s.shipName,r.push(i+10*t)}i.push(s)},receiveAttack:function(r,a){let s=o(r,a);null!=e[s].name?n.includes(s)||(n.push(s),function(e){for(let t=0;t<i.length;t++)if(i[t].shipName==e)return i[t]}(e[s].name).hit()):t.includes(s)||t.push(s)},isAllSunk:function(){if(r.length==n.length)return!0},getMissedPositions:function(){return t},getAttackedPositions:function(){return n},getShipsPositions:function(){return r}}}(),n=[e(5,"Carrier"),e(4,"Battleship"),e(3,"Cruiser"),e(3,"Submarine"),e(2,"Destroyer")];function r(){return[Math.floor(10*Math.random()),Math.floor(10*Math.random())]}return{randomAttack:function e(t){let n=r(),i=n[0],o=n[1],a=function(e,t){return 10*e+t}(i,o);t.getShotCoordinates().includes(a)?e(t):t.receiveAttack(i,o)},randomPlacement:function e(n){let i=r(),o=i[0],a=i[1],s="";s=1==Math.floor(2*Math.random())?"Horizontal":"Vertical",t.checkValidity(o,a,n,s)?t.placeShip(o,a,n,s):e(n)},getBoard:function(){return t},getShips:function(){return n},getShotCoordinates:function(){return[...t.getAttackedPositions(),...t.getMissedPositions()]},createBoard:t.createBoard,getBoard:t.getBoard,placeShip:t.placeShip,checkValidity:t.checkValidity,receiveAttack:t.receiveAttack,isAllSunk:t.isAllSunk,getMissedPositions:t.getMissedPositions,getAttackedPositions:t.getAttackedPositions,getShipsPositions:t.getShipsPositions}},n=function(){let e=t(),n=t();e.createBoard(),n.createBoard();let r=e.getBoard(),i=n.getBoard(),o=e.getShips(),a=n.getShips(),s="Gamer",c="",l=[];return{gamer:e,computer:n,setInput:function(e){l=e},gameLoop:function(){"Gamer"==s&&(n.receiveAttack(l[0],l[1]),n.isAllSunk()?c="Gamer":(s="Computer",l=[])),"Computer"==s&&(n.randomAttack(e),e.isAllSunk()?c="Computer":s="Gamer"),console.log(c)},getTurn:function(){return s},getWinner:function(){return c},getGamerBoard:function(){return r},getComputerBoard:function(){return i},getGamerShips:function(){return o},getComputerShips:function(){return a}}}(),r=function(){const e=document.querySelector(".display"),t=document.querySelector(".player-board"),i=document.querySelector(".computer-board"),o=document.querySelector(".direction"),a=document.querySelector(".reset");let s=n.getGamerBoard(),c=n.getComputerBoard(),l=[...n.getGamerShips()],d=[...n.getComputerShips()];function u(e){let t=e.classList[1].split(",");return[parseInt(t[0]),parseInt(t[1])]}return window.addEventListener("load",(()=>{e.textContent="Welcome to Battleship. Place your Carrier"})),window.addEventListener("click",(()=>{switch(l.length){case 4:e.textContent="Place your Battleship";break;case 3:e.textContent="Place your Cruiser";break;case 2:e.textContent="Place your Submarine";break;case 1:e.textContent="Place your Destroyer";break;case 0:""==n.getWinner()?e.textContent=`${n.getTurn()}'s Turn`:e.textContent=`${n.getWinner()} Won`}})),function(){let e,r,i=l[0];t.addEventListener("click",(a=>{if(a.target.classList.contains("player-board")){let c=a.target;if(e=u(c)[0],r=u(c)[1],l.length>0&&n.gamer.checkValidity(e,r,i,o.value)){n.gamer.placeShip(e,r,i,o.value),l.shift(),i=l[0];let a=n.gamer.getShipsPositions();for(let e=0;e<a.length;e++)t.children[a[e]].classList.add("player-ship");console.log(s)}}})),t.addEventListener("mouseover",(t=>{if(t.target.classList.contains("grid")){let a=t.target;e=u(a)[0],r=u(a)[1],l.length>0&&n.gamer.checkValidity(e,r,i,o.value)?a.classList.add("green"):l.length>0&&a.classList.add("red")}})),t.addEventListener("mouseout",(e=>{if(e.target.classList.contains("grid")){(t=e.target).classList.remove("green"),t.classList.remove("red")}var t}))}(),o.addEventListener("click",(()=>{"Horizontal"==o.value?(o.value="Vertical",o.textContent="Set Horizontal"):(o.value="Horizontal",o.textContent="Set Vertical")})),function(){let e=d[0];window.addEventListener("click",(()=>{for(;d.length>0;)n.computer.randomPlacement(e),d.shift(),e=d[0];let t=n.computer.getShipsPositions();for(let e=0;e<t.length;e++)i.children[t[e]].classList.add("computer-ship")}))}(),i.addEventListener("click",(e=>{if(0==l.length&&e.target.classList.contains("computer-board")){let t=e.target,r=parseInt(t.classList[0]),i=u(t)[0],o=u(t)[1];n.computer.getShotCoordinates().includes(r)||""!=n.getWinner()||0!=l.length||(n.setInput([i,o]),n.gameLoop())}})),window.addEventListener("click",(()=>{let e=n.gamer.getMissedPositions(),r=n.computer.getMissedPositions(),o=n.gamer.getAttackedPositions(),a=n.computer.getAttackedPositions();for(let n=0;n<e.length;n++)t.children[e[n]].classList.add("missed");for(let e=0;e<r.length;e++)i.children[r[e]].classList.add("missed");for(let e=0;e<o.length;e++)t.children[o[e]].classList.add("attacked");for(let e=0;e<a.length;e++)i.children[a[e]].classList.add("attacked")})),a.addEventListener("click",(()=>{for(;t.hasChildNodes();)t.removeChild(t.firstChild);for(;i.hasChildNodes();)i.removeChild(i.firstChild);r.createGameBoards()})),{createGameBoards:function(){for(let e=0;e<s.length;e++){let n=document.createElement("div");n.classList.add(e),n.classList.add(s[e].coordinates),n.classList.add("grid"),n.classList.add("player-board"),t.appendChild(n)}for(let e=0;e<c.length;e++){let t=document.createElement("div");t.classList.add(e),t.classList.add(c[e].coordinates),t.classList.add("grid"),t.classList.add("computer-board"),i.appendChild(t)}}}}();r.createGameBoards()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9kb20uanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzaGlwID0gZnVuY3Rpb24gKGxlbmd0aCwgbmFtZSkge1xuICBsZXQgaGl0cyA9IDA7XG4gIGxldCBzdW5rID0gZmFsc2U7XG4gIGxldCBzaGlwTmFtZSA9IG5hbWU7XG5cbiAgZnVuY3Rpb24gaGl0KCkge1xuICAgIGhpdHMgKz0gMTtcbiAgICByZXR1cm4gaGl0cztcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzU3VuaygpIHtcbiAgICBpZiAoaGl0cyA9PSBsZW5ndGgpIHtcbiAgICAgIHN1bmsgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gc3VuaztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEhpdHMoKSB7XG4gICAgcmV0dXJuIGhpdHM7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGhpdCxcbiAgICBnZXRIaXRzLFxuICAgIGlzU3VuayxcbiAgICBsZW5ndGgsXG4gICAgc2hpcE5hbWUsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzaGlwO1xuIiwiaW1wb3J0IHNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuY29uc3QgcGxheWVyID0gZnVuY3Rpb24gKCkge1xuICBsZXQgYm9hcmQgPSBnYW1lQm9hcmQoKTtcbiAgbGV0IGNhcnJpZXIgPSBzaGlwKDUsIFwiQ2FycmllclwiKTtcbiAgbGV0IGJhdHRsZXNoaXAgPSBzaGlwKDQsIFwiQmF0dGxlc2hpcFwiKTtcbiAgbGV0IGNydWlzZXIgPSBzaGlwKDMsIFwiQ3J1aXNlclwiKTtcbiAgbGV0IHN1Ym1hcmluZSA9IHNoaXAoMywgXCJTdWJtYXJpbmVcIik7XG4gIGxldCBkZXN0cm95ZXIgPSBzaGlwKDIsIFwiRGVzdHJveWVyXCIpO1xuICBsZXQgc2hpcHMgPSBbY2FycmllciwgYmF0dGxlc2hpcCwgY3J1aXNlciwgc3VibWFyaW5lLCBkZXN0cm95ZXJdO1xuXG4gIGZ1bmN0aW9uIGluZGV4RmluZGVyKHBvczEsIHBvczIpIHtcbiAgICBsZXQgaW5kZXggPSBwb3MxICogMTAgKyBwb3MyO1xuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJhbmRvbUNvb3JkaW5hdGVzKCkge1xuICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuXG4gICAgcmV0dXJuIFt4LCB5XTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJhbmRvbUF0dGFjayhwbGF5ZXIpIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSByYW5kb21Db29yZGluYXRlcygpO1xuICAgIGxldCBwb3MxID0gY29vcmRpbmF0ZXNbMF07XG4gICAgbGV0IHBvczIgPSBjb29yZGluYXRlc1sxXTtcblxuICAgIGxldCBpbmRleCA9IGluZGV4RmluZGVyKHBvczEsIHBvczIpO1xuXG4gICAgaWYgKHBsYXllci5nZXRTaG90Q29vcmRpbmF0ZXMoKS5pbmNsdWRlcyhpbmRleCkpIHtcbiAgICAgIHJhbmRvbUF0dGFjayhwbGF5ZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwbGF5ZXIucmVjZWl2ZUF0dGFjayhwb3MxLCBwb3MyKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByYW5kb21QbGFjZW1lbnQoc2hpcCkge1xuICAgIGxldCBjb29yZGluYXRlcyA9IHJhbmRvbUNvb3JkaW5hdGVzKCk7XG4gICAgbGV0IHBvczEgPSBjb29yZGluYXRlc1swXTtcbiAgICBsZXQgcG9zMiA9IGNvb3JkaW5hdGVzWzFdO1xuICAgIGxldCBkaXJlY3Rpb24gPSBcIlwiO1xuXG4gICAgbGV0IHJhbmRvbURpcmVjdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xuXG4gICAgaWYgKHJhbmRvbURpcmVjdGlvbiA9PSAxKSB7XG4gICAgICBkaXJlY3Rpb24gPSBcIkhvcml6b250YWxcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgZGlyZWN0aW9uID0gXCJWZXJ0aWNhbFwiO1xuICAgIH1cblxuICAgIGlmIChib2FyZC5jaGVja1ZhbGlkaXR5KHBvczEsIHBvczIsIHNoaXAsIGRpcmVjdGlvbikpIHtcbiAgICAgIGJvYXJkLnBsYWNlU2hpcChwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICByYW5kb21QbGFjZW1lbnQoc2hpcCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Qm9hcmQoKSB7XG4gICAgcmV0dXJuIGJvYXJkO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U2hpcHMoKSB7XG4gICAgcmV0dXJuIHNoaXBzO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U2hvdENvb3JkaW5hdGVzKCkge1xuICAgIGxldCBhdHRhY2tlZCA9IGJvYXJkLmdldEF0dGFja2VkUG9zaXRpb25zKCk7XG4gICAgbGV0IG1pc3NlZCA9IGJvYXJkLmdldE1pc3NlZFBvc2l0aW9ucygpO1xuICAgIGxldCBzaG90Q29vcmRpbmF0ZXMgPSBbLi4uYXR0YWNrZWQsIC4uLm1pc3NlZF07XG4gICAgcmV0dXJuIHNob3RDb29yZGluYXRlcztcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcmFuZG9tQXR0YWNrLFxuICAgIHJhbmRvbVBsYWNlbWVudCxcbiAgICBnZXRCb2FyZCxcbiAgICBnZXRTaGlwcyxcbiAgICBnZXRTaG90Q29vcmRpbmF0ZXMsXG4gICAgY3JlYXRlQm9hcmQ6IGJvYXJkLmNyZWF0ZUJvYXJkLFxuICAgIGdldEJvYXJkOiBib2FyZC5nZXRCb2FyZCxcbiAgICBwbGFjZVNoaXA6IGJvYXJkLnBsYWNlU2hpcCxcbiAgICBjaGVja1ZhbGlkaXR5OiBib2FyZC5jaGVja1ZhbGlkaXR5LFxuICAgIHJlY2VpdmVBdHRhY2s6IGJvYXJkLnJlY2VpdmVBdHRhY2ssXG4gICAgaXNBbGxTdW5rOiBib2FyZC5pc0FsbFN1bmssXG4gICAgZ2V0TWlzc2VkUG9zaXRpb25zOiBib2FyZC5nZXRNaXNzZWRQb3NpdGlvbnMsXG4gICAgZ2V0QXR0YWNrZWRQb3NpdGlvbnM6IGJvYXJkLmdldEF0dGFja2VkUG9zaXRpb25zLFxuICAgIGdldFNoaXBzUG9zaXRpb25zOiBib2FyZC5nZXRTaGlwc1Bvc2l0aW9ucyxcbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHBsYXllcjtcbiIsImltcG9ydCBzaGlwIGZyb20gXCIuL3NoaXBcIjtcbmNvbnN0IGdhbWVCb2FyZCA9IGZ1bmN0aW9uICgpIHtcbiAgbGV0IGJvYXJkID0gW107XG4gIGxldCBtaXNzZWRBdHRhY2sgPSBbXTtcbiAgbGV0IGF0dGFja2VkUG9zaXRpb24gPSBbXTtcbiAgbGV0IHNoaXBQb3NpdGlvbiA9IFtdO1xuICBsZXQgc2hpcHMgPSBbXTtcblxuICBmdW5jdGlvbiBjcmVhdGVDb29yZGluYXRlKGNvb3JkaW5hdGVzLCBuYW1lKSB7XG4gICAgcmV0dXJuIHsgY29vcmRpbmF0ZXMsIG5hbWUgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGluZGV4RmluZGVyKHBvczEsIHBvczIpIHtcbiAgICBsZXQgaW5kZXggPSBwb3MxICogMTAgKyBwb3MyO1xuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZUJvYXJkKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIGxldCBuZXdDb29yZGluYXRlcyA9IGNyZWF0ZUNvb3JkaW5hdGUoKTtcbiAgICAgICAgbmV3Q29vcmRpbmF0ZXMuY29vcmRpbmF0ZXMgPSBbaSwgal07XG4gICAgICAgIG5ld0Nvb3JkaW5hdGVzLm5hbWUgPSBudWxsO1xuICAgICAgICBib2FyZC5wdXNoKG5ld0Nvb3JkaW5hdGVzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJvYXJkO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tWYWxpZGl0eShwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pIHtcbiAgICBsZXQgaW5kZXggPSBpbmRleEZpbmRlcihwb3MxLCBwb3MyKTtcblxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJIb3Jpem9udGFsXCIpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoc2hpcFBvc2l0aW9uLmluY2x1ZGVzKGluZGV4ICsgaSkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZGlyZWN0aW9uID09IFwiVmVydGljYWxcIikge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChzaGlwUG9zaXRpb24uaW5jbHVkZXMoaW5kZXggKyBpICogMTApKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcIkhvcml6b250YWxcIiAmJiBwb3MyICsgc2hpcC5sZW5ndGggPiAxMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJWZXJ0aWNhbFwiICYmIHBvczEgKyBzaGlwLmxlbmd0aCA+IDEwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxhY2VTaGlwKHBvczEsIHBvczIsIHNoaXAsIGRpcmVjdGlvbikge1xuICAgIGlmIChcbiAgICAgIGRpcmVjdGlvbiA9PSBcIkhvcml6b250YWxcIiAmJlxuICAgICAgY2hlY2tWYWxpZGl0eShwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pXG4gICAgKSB7XG4gICAgICBsZXQgaW5kZXggPSBpbmRleEZpbmRlcihwb3MxLCBwb3MyKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJvYXJkW2luZGV4ICsgaV0ubmFtZSA9IHNoaXAuc2hpcE5hbWU7XG4gICAgICAgIHNoaXBQb3NpdGlvbi5wdXNoKGluZGV4ICsgaSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcIlZlcnRpY2FsXCIgJiYgY2hlY2tWYWxpZGl0eShwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pKSB7XG4gICAgICBsZXQgaW5kZXggPSBpbmRleEZpbmRlcihwb3MxLCBwb3MyKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJvYXJkW2luZGV4ICsgaSAqIDEwXS5uYW1lID0gc2hpcC5zaGlwTmFtZTtcbiAgICAgICAgc2hpcFBvc2l0aW9uLnB1c2goaW5kZXggKyBpICogMTApO1xuICAgICAgfVxuICAgIH1cbiAgICBzaGlwcy5wdXNoKHNoaXApO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVjZWl2ZUF0dGFjayhwb3MxLCBwb3MyKSB7XG4gICAgbGV0IGluZGV4ID0gaW5kZXhGaW5kZXIocG9zMSwgcG9zMik7XG5cbiAgICBpZiAoYm9hcmRbaW5kZXhdLm5hbWUgIT0gbnVsbCkge1xuICAgICAgaWYgKCFhdHRhY2tlZFBvc2l0aW9uLmluY2x1ZGVzKGluZGV4KSkge1xuICAgICAgICBhdHRhY2tlZFBvc2l0aW9uLnB1c2goaW5kZXgpO1xuICAgICAgICBmaW5kU2hpcChib2FyZFtpbmRleF0ubmFtZSkuaGl0KCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghbWlzc2VkQXR0YWNrLmluY2x1ZGVzKGluZGV4KSkge1xuICAgICAgICBtaXNzZWRBdHRhY2sucHVzaChpbmRleCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZmluZFNoaXAobmFtZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzaGlwc1tpXS5zaGlwTmFtZSA9PSBuYW1lKSB7XG4gICAgICAgIHJldHVybiBzaGlwc1tpXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBpc0FsbFN1bmsoKSB7XG4gICAgaWYgKHNoaXBQb3NpdGlvbi5sZW5ndGggPT0gYXR0YWNrZWRQb3NpdGlvbi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEJvYXJkKCkge1xuICAgIHJldHVybiBib2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldE1pc3NlZFBvc2l0aW9ucygpIHtcbiAgICByZXR1cm4gbWlzc2VkQXR0YWNrO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U2hpcHNQb3NpdGlvbnMoKSB7XG4gICAgcmV0dXJuIHNoaXBQb3NpdGlvbjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEF0dGFja2VkUG9zaXRpb25zKCkge1xuICAgIHJldHVybiBhdHRhY2tlZFBvc2l0aW9uO1xuICB9XG4gIHJldHVybiB7XG4gICAgY3JlYXRlQm9hcmQsXG4gICAgZ2V0Qm9hcmQsXG4gICAgY2hlY2tWYWxpZGl0eSxcbiAgICBwbGFjZVNoaXAsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBpc0FsbFN1bmssXG4gICAgZ2V0TWlzc2VkUG9zaXRpb25zLFxuICAgIGdldEF0dGFja2VkUG9zaXRpb25zLFxuICAgIGdldFNoaXBzUG9zaXRpb25zLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZ2FtZUJvYXJkO1xuIiwiaW1wb3J0IHNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBwbGF5ZXIgZnJvbSBcIi4vcGxheWVyXCI7XG5cbmNvbnN0IGdhbWUgPSAoZnVuY3Rpb24gKCkge1xuICBsZXQgZ2FtZXIgPSBwbGF5ZXIoKTtcbiAgbGV0IGNvbXB1dGVyID0gcGxheWVyKCk7XG5cbiAgZ2FtZXIuY3JlYXRlQm9hcmQoKTtcbiAgY29tcHV0ZXIuY3JlYXRlQm9hcmQoKTtcblxuICBsZXQgZ2FtZXJCb2FyZCA9IGdhbWVyLmdldEJvYXJkKCk7XG4gIGxldCBjb21wdXRlckJvYXJkID0gY29tcHV0ZXIuZ2V0Qm9hcmQoKTtcbiAgbGV0IGdhbWVyU2hpcHMgPSBnYW1lci5nZXRTaGlwcygpO1xuICBsZXQgY29tcHV0ZXJTaGlwcyA9IGNvbXB1dGVyLmdldFNoaXBzKCk7XG5cbiAgbGV0IHR1cm4gPSBcIkdhbWVyXCI7XG4gIGxldCB3aW5uZXIgPSBcIlwiO1xuICBsZXQgaW5wdXQgPSBbXTtcblxuICBmdW5jdGlvbiBnYW1lTG9vcCgpIHtcbiAgICBpZiAodHVybiA9PSBcIkdhbWVyXCIpIHtcbiAgICAgIGNvbXB1dGVyLnJlY2VpdmVBdHRhY2soaW5wdXRbMF0sIGlucHV0WzFdKTtcbiAgICAgIGlmIChjb21wdXRlci5pc0FsbFN1bmsoKSkge1xuICAgICAgICB3aW5uZXIgPSBcIkdhbWVyXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0dXJuID0gXCJDb21wdXRlclwiO1xuICAgICAgICBpbnB1dCA9IFtdO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHVybiA9PSBcIkNvbXB1dGVyXCIpIHtcbiAgICAgIGNvbXB1dGVyLnJhbmRvbUF0dGFjayhnYW1lcik7XG4gICAgICBpZiAoZ2FtZXIuaXNBbGxTdW5rKCkpIHtcbiAgICAgICAgd2lubmVyID0gXCJDb21wdXRlclwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHVybiA9IFwiR2FtZXJcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc29sZS5sb2cod2lubmVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldElucHV0KGNvb3JkaW5hdGVzKSB7XG4gICAgaW5wdXQgPSBjb29yZGluYXRlcztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFR1cm4oKSB7XG4gICAgcmV0dXJuIHR1cm47XG4gIH1cblxuICBmdW5jdGlvbiBnZXRXaW5uZXIoKSB7XG4gICAgcmV0dXJuIHdpbm5lcjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEdhbWVyQm9hcmQoKSB7XG4gICAgcmV0dXJuIGdhbWVyQm9hcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRDb21wdXRlckJvYXJkKCkge1xuICAgIHJldHVybiBjb21wdXRlckJvYXJkO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0R2FtZXJTaGlwcygpIHtcbiAgICByZXR1cm4gZ2FtZXJTaGlwcztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldENvbXB1dGVyU2hpcHMoKSB7XG4gICAgcmV0dXJuIGNvbXB1dGVyU2hpcHM7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdhbWVyLFxuICAgIGNvbXB1dGVyLFxuICAgIHNldElucHV0LFxuICAgIGdhbWVMb29wLFxuICAgIGdldFR1cm4sXG4gICAgZ2V0V2lubmVyLFxuICAgIGdldEdhbWVyQm9hcmQsXG4gICAgZ2V0Q29tcHV0ZXJCb2FyZCxcbiAgICBnZXRHYW1lclNoaXBzLFxuICAgIGdldENvbXB1dGVyU2hpcHMsXG4gIH07XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBnYW1lO1xuIiwiaW1wb3J0IHNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBwbGF5ZXIgZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQgZ2FtZSBmcm9tIFwiLi9nYW1lXCI7XG5cbmNvbnN0IGRvbSA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGRpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpc3BsYXlcIik7XG4gIGNvbnN0IHBsYXllckJvYXJkRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItYm9hcmRcIik7XG4gIGNvbnN0IGNvbXB1dGVyQm9hcmREaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXB1dGVyLWJvYXJkXCIpO1xuICBjb25zdCBkaXJlY3Rpb25CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpcmVjdGlvblwiKTtcbiAgY29uc3QgcmVzZXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJlc2V0XCIpO1xuXG4gIGxldCBnYW1lckJvYXJkID0gZ2FtZS5nZXRHYW1lckJvYXJkKCk7XG4gIGxldCBjb21wdXRlckJvYXJkID0gZ2FtZS5nZXRDb21wdXRlckJvYXJkKCk7XG4gIGxldCBnYW1lclNoaXBzID0gWy4uLmdhbWUuZ2V0R2FtZXJTaGlwcygpXTtcbiAgbGV0IGNvbXB1dGVyU2hpcHMgPSBbLi4uZ2FtZS5nZXRDb21wdXRlclNoaXBzKCldO1xuXG4gIGZ1bmN0aW9uIGNyZWF0ZUdhbWVCb2FyZHMoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnYW1lckJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgZ3JpZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoaSk7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoZ2FtZXJCb2FyZFtpXS5jb29yZGluYXRlcyk7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoXCJncmlkXCIpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKFwicGxheWVyLWJvYXJkXCIpO1xuICAgICAgcGxheWVyQm9hcmREaXYuYXBwZW5kQ2hpbGQoZ3JpZCk7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29tcHV0ZXJCb2FyZC5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGdyaWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKGkpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKGNvbXB1dGVyQm9hcmRbaV0uY29vcmRpbmF0ZXMpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKFwiZ3JpZFwiKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChcImNvbXB1dGVyLWJvYXJkXCIpO1xuICAgICAgY29tcHV0ZXJCb2FyZERpdi5hcHBlbmRDaGlsZChncmlkKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRDb29yZGluYXRlcyh0YXJnZXQpIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSB0YXJnZXQuY2xhc3NMaXN0WzFdLnNwbGl0KFwiLFwiKTtcbiAgICBsZXQgcG9zMSA9IHBhcnNlSW50KGNvb3JkaW5hdGVzWzBdKTtcbiAgICBsZXQgcG9zMiA9IHBhcnNlSW50KGNvb3JkaW5hdGVzWzFdKTtcblxuICAgIHJldHVybiBbcG9zMSwgcG9zMl07XG4gIH1cblxuICBmdW5jdGlvbiBhZGRWYWxpZGl0eUNvbG9yKGNlbGwpIHtcbiAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJncmVlblwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZVZhbGlkaXR5Q29sb3IoY2VsbCkge1xuICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZShcImdyZWVuXCIpO1xuICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZShcInJlZFwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZE5vblZhbGlkaXR5Q29sb3IoY2VsbCkge1xuICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcInJlZFwiKTtcbiAgfVxuXG4gIChmdW5jdGlvbiBkaXNwbGF5RXZlbnRzKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiB7XG4gICAgICBkaXNwbGF5LnRleHRDb250ZW50ID0gXCJXZWxjb21lIHRvIEJhdHRsZXNoaXAuIFBsYWNlIHlvdXIgQ2FycmllclwiO1xuICAgIH0pO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBzd2l0Y2ggKGdhbWVyU2hpcHMubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBkaXNwbGF5LnRleHRDb250ZW50ID0gXCJQbGFjZSB5b3VyIEJhdHRsZXNoaXBcIjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgQ3J1aXNlclwiO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IFwiUGxhY2UgeW91ciBTdWJtYXJpbmVcIjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgRGVzdHJveWVyXCI7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgIGlmIChnYW1lLmdldFdpbm5lcigpID09IFwiXCIpIHtcbiAgICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBgJHtnYW1lLmdldFR1cm4oKX0ncyBUdXJuYDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IGAke2dhbWUuZ2V0V2lubmVyKCl9IFdvbmA7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KSgpO1xuXG4gIChmdW5jdGlvbiBwbGF5ZXJCb2FyZEV2ZW50cygpIHtcbiAgICBsZXQgY3VycmVudFNoaXAgPSBnYW1lclNoaXBzWzBdO1xuICAgIGxldCBwb3MxO1xuICAgIGxldCBwb3MyO1xuXG4gICAgcGxheWVyQm9hcmREaXYuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChncmlkKSA9PiB7XG4gICAgICBpZiAoZ3JpZC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicGxheWVyLWJvYXJkXCIpKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgcG9zMSA9IGdldENvb3JkaW5hdGVzKHRhcmdldClbMF07XG4gICAgICAgIHBvczIgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzFdO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgZ2FtZXJTaGlwcy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgZ2FtZS5nYW1lci5jaGVja1ZhbGlkaXR5KFxuICAgICAgICAgICAgcG9zMSxcbiAgICAgICAgICAgIHBvczIsXG4gICAgICAgICAgICBjdXJyZW50U2hpcCxcbiAgICAgICAgICAgIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZVxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgZ2FtZS5nYW1lci5wbGFjZVNoaXAocG9zMSwgcG9zMiwgY3VycmVudFNoaXAsIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZSk7XG4gICAgICAgICAgZ2FtZXJTaGlwcy5zaGlmdCgpO1xuICAgICAgICAgIGN1cnJlbnRTaGlwID0gZ2FtZXJTaGlwc1swXTtcbiAgICAgICAgICBsZXQgc2hpcFBvc2l0aW9ucyA9IGdhbWUuZ2FtZXIuZ2V0U2hpcHNQb3NpdGlvbnMoKTtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW3NoaXBQb3NpdGlvbnNbaV1dLmNsYXNzTGlzdC5hZGQoXG4gICAgICAgICAgICAgIFwicGxheWVyLXNoaXBcIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc29sZS5sb2coZ2FtZXJCb2FyZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHBsYXllckJvYXJkRGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgKGdyaWQpID0+IHtcbiAgICAgIGlmIChncmlkLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJncmlkXCIpKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgcG9zMSA9IGdldENvb3JkaW5hdGVzKHRhcmdldClbMF07XG4gICAgICAgIHBvczIgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzFdO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgZ2FtZXJTaGlwcy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgZ2FtZS5nYW1lci5jaGVja1ZhbGlkaXR5KFxuICAgICAgICAgICAgcG9zMSxcbiAgICAgICAgICAgIHBvczIsXG4gICAgICAgICAgICBjdXJyZW50U2hpcCxcbiAgICAgICAgICAgIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZVxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgYWRkVmFsaWRpdHlDb2xvcih0YXJnZXQpO1xuICAgICAgICB9IGVsc2UgaWYgKGdhbWVyU2hpcHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGFkZE5vblZhbGlkaXR5Q29sb3IodGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcGxheWVyQm9hcmREaXYuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsIChncmlkKSA9PiB7XG4gICAgICBpZiAoZ3JpZC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZ3JpZFwiKSkge1xuICAgICAgICBsZXQgdGFyZ2V0ID0gZ3JpZC50YXJnZXQ7XG4gICAgICAgIHJlbW92ZVZhbGlkaXR5Q29sb3IodGFyZ2V0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSkoKTtcblxuICBkaXJlY3Rpb25CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBpZiAoZGlyZWN0aW9uQnV0dG9uLnZhbHVlID09IFwiSG9yaXpvbnRhbFwiKSB7XG4gICAgICBkaXJlY3Rpb25CdXR0b24udmFsdWUgPSBcIlZlcnRpY2FsXCI7XG4gICAgICBkaXJlY3Rpb25CdXR0b24udGV4dENvbnRlbnQgPSBcIlNldCBIb3Jpem9udGFsXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZSA9IFwiSG9yaXpvbnRhbFwiO1xuICAgICAgZGlyZWN0aW9uQnV0dG9uLnRleHRDb250ZW50ID0gXCJTZXQgVmVydGljYWxcIjtcbiAgICB9XG4gIH0pO1xuXG4gIChmdW5jdGlvbiBjb21wdXRlckJvYXJkRXZlbnRzKCkge1xuICAgIGxldCBjdXJyZW50U2hpcCA9IGNvbXB1dGVyU2hpcHNbMF07XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB3aGlsZSAoY29tcHV0ZXJTaGlwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGdhbWUuY29tcHV0ZXIucmFuZG9tUGxhY2VtZW50KGN1cnJlbnRTaGlwKTtcbiAgICAgICAgY29tcHV0ZXJTaGlwcy5zaGlmdCgpO1xuICAgICAgICBjdXJyZW50U2hpcCA9IGNvbXB1dGVyU2hpcHNbMF07XG4gICAgICB9XG4gICAgICBsZXQgc2hpcFBvc2l0aW9ucyA9IGdhbWUuY29tcHV0ZXIuZ2V0U2hpcHNQb3NpdGlvbnMoKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcFBvc2l0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW3NoaXBQb3NpdGlvbnNbaV1dLmNsYXNzTGlzdC5hZGQoXG4gICAgICAgICAgXCJjb21wdXRlci1zaGlwXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSkoKTtcblxuICAoZnVuY3Rpb24gZ2FtZUxvb3BFdmVudHMoKSB7XG4gICAgY29tcHV0ZXJCb2FyZERpdi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGdyaWQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZ2FtZXJTaGlwcy5sZW5ndGggPT0gMCAmJlxuICAgICAgICBncmlkLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjb21wdXRlci1ib2FyZFwiKVxuICAgICAgKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgbGV0IGluZGV4ID0gcGFyc2VJbnQodGFyZ2V0LmNsYXNzTGlzdFswXSk7XG4gICAgICAgIGxldCBwb3MxID0gZ2V0Q29vcmRpbmF0ZXModGFyZ2V0KVswXTtcbiAgICAgICAgbGV0IHBvczIgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzFdO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAhZ2FtZS5jb21wdXRlci5nZXRTaG90Q29vcmRpbmF0ZXMoKS5pbmNsdWRlcyhpbmRleCkgJiZcbiAgICAgICAgICBnYW1lLmdldFdpbm5lcigpID09IFwiXCIgJiZcbiAgICAgICAgICBnYW1lclNoaXBzLmxlbmd0aCA9PSAwXG4gICAgICAgICkge1xuICAgICAgICAgIGdhbWUuc2V0SW5wdXQoW3BvczEsIHBvczJdKTtcbiAgICAgICAgICBnYW1lLmdhbWVMb29wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgbGV0IGdhbWVyTWlzc2VkUG9zID0gZ2FtZS5nYW1lci5nZXRNaXNzZWRQb3NpdGlvbnMoKTtcbiAgICAgIGxldCBjb21wdXRlck1pc3NlZFBvcyA9IGdhbWUuY29tcHV0ZXIuZ2V0TWlzc2VkUG9zaXRpb25zKCk7XG4gICAgICBsZXQgZ2FtZXJBdHRhY2tlZFBvcyA9IGdhbWUuZ2FtZXIuZ2V0QXR0YWNrZWRQb3NpdGlvbnMoKTtcbiAgICAgIGxldCBjb21wdXRlckF0dGFja2VkUG9zID0gZ2FtZS5jb21wdXRlci5nZXRBdHRhY2tlZFBvc2l0aW9ucygpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdhbWVyTWlzc2VkUG9zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW2dhbWVyTWlzc2VkUG9zW2ldXS5jbGFzc0xpc3QuYWRkKFwibWlzc2VkXCIpO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb21wdXRlck1pc3NlZFBvcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW2NvbXB1dGVyTWlzc2VkUG9zW2ldXS5jbGFzc0xpc3QuYWRkKFwibWlzc2VkXCIpO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnYW1lckF0dGFja2VkUG9zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW2dhbWVyQXR0YWNrZWRQb3NbaV1dLmNsYXNzTGlzdC5hZGQoXCJhdHRhY2tlZFwiKTtcbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29tcHV0ZXJBdHRhY2tlZFBvcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW2NvbXB1dGVyQXR0YWNrZWRQb3NbaV1dLmNsYXNzTGlzdC5hZGQoXG4gICAgICAgICAgXCJhdHRhY2tlZFwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pKCk7XG5cbiAgKGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgIHJlc2V0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBkb207XG4gICAgICBnYW1lO1xuICAgICAgd2hpbGUgKHBsYXllckJvYXJkRGl2Lmhhc0NoaWxkTm9kZXMoKSkge1xuICAgICAgICBwbGF5ZXJCb2FyZERpdi5yZW1vdmVDaGlsZChwbGF5ZXJCb2FyZERpdi5maXJzdENoaWxkKTtcbiAgICAgIH1cbiAgICAgIHdoaWxlIChjb21wdXRlckJvYXJkRGl2Lmhhc0NoaWxkTm9kZXMoKSkge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LnJlbW92ZUNoaWxkKGNvbXB1dGVyQm9hcmREaXYuZmlyc3RDaGlsZCk7XG4gICAgICB9XG4gICAgICBkb20uY3JlYXRlR2FtZUJvYXJkcygpO1xuICAgIH0pO1xuICB9KSgpO1xuXG4gIHJldHVybiB7XG4gICAgY3JlYXRlR2FtZUJvYXJkcyxcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGRvbTtcbiIsImltcG9ydCBkb20gZnJvbSBcIi4vZG9tXCI7XG5pbXBvcnQgc2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgZ2FtZUJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xuaW1wb3J0IHBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCBnYW1lIGZyb20gXCIuL2dhbWVcIjtcblxuZG9tLmNyZWF0ZUdhbWVCb2FyZHMoKTtcbmdhbWU7XG4iXSwibmFtZXMiOlsibGVuZ3RoIiwibmFtZSIsImhpdHMiLCJzdW5rIiwiaGl0IiwiZ2V0SGl0cyIsImlzU3VuayIsInNoaXBOYW1lIiwiYm9hcmQiLCJtaXNzZWRBdHRhY2siLCJhdHRhY2tlZFBvc2l0aW9uIiwic2hpcFBvc2l0aW9uIiwic2hpcHMiLCJpbmRleEZpbmRlciIsInBvczEiLCJwb3MyIiwiY2hlY2tWYWxpZGl0eSIsInNoaXAiLCJkaXJlY3Rpb24iLCJpbmRleCIsImkiLCJpbmNsdWRlcyIsImNyZWF0ZUJvYXJkIiwiaiIsIm5ld0Nvb3JkaW5hdGVzIiwiY29vcmRpbmF0ZXMiLCJjcmVhdGVDb29yZGluYXRlIiwicHVzaCIsImdldEJvYXJkIiwicGxhY2VTaGlwIiwicmVjZWl2ZUF0dGFjayIsImZpbmRTaGlwIiwiaXNBbGxTdW5rIiwiZ2V0TWlzc2VkUG9zaXRpb25zIiwiZ2V0QXR0YWNrZWRQb3NpdGlvbnMiLCJnZXRTaGlwc1Bvc2l0aW9ucyIsInJhbmRvbUNvb3JkaW5hdGVzIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmFuZG9tQXR0YWNrIiwicGxheWVyIiwiZ2V0U2hvdENvb3JkaW5hdGVzIiwicmFuZG9tUGxhY2VtZW50IiwiZ2V0U2hpcHMiLCJnYW1lciIsImNvbXB1dGVyIiwiZ2FtZXJCb2FyZCIsImNvbXB1dGVyQm9hcmQiLCJnYW1lclNoaXBzIiwiY29tcHV0ZXJTaGlwcyIsInR1cm4iLCJ3aW5uZXIiLCJpbnB1dCIsInNldElucHV0IiwiZ2FtZUxvb3AiLCJjb25zb2xlIiwibG9nIiwiZ2V0VHVybiIsImdldFdpbm5lciIsImdldEdhbWVyQm9hcmQiLCJnZXRDb21wdXRlckJvYXJkIiwiZ2V0R2FtZXJTaGlwcyIsImdldENvbXB1dGVyU2hpcHMiLCJkb20iLCJkaXNwbGF5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicGxheWVyQm9hcmREaXYiLCJjb21wdXRlckJvYXJkRGl2IiwiZGlyZWN0aW9uQnV0dG9uIiwicmVzZXRCdXR0b24iLCJnZXRDb29yZGluYXRlcyIsInRhcmdldCIsImNsYXNzTGlzdCIsInNwbGl0IiwicGFyc2VJbnQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwidGV4dENvbnRlbnQiLCJjdXJyZW50U2hpcCIsImdyaWQiLCJjb250YWlucyIsInZhbHVlIiwic2hpZnQiLCJzaGlwUG9zaXRpb25zIiwiY2hpbGRyZW4iLCJhZGQiLCJjZWxsIiwicmVtb3ZlIiwiZ2FtZXJNaXNzZWRQb3MiLCJjb21wdXRlck1pc3NlZFBvcyIsImdhbWVyQXR0YWNrZWRQb3MiLCJjb21wdXRlckF0dGFja2VkUG9zIiwiaGFzQ2hpbGROb2RlcyIsInJlbW92ZUNoaWxkIiwiZmlyc3RDaGlsZCIsImNyZWF0ZUdhbWVCb2FyZHMiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiXSwic291cmNlUm9vdCI6IiJ9