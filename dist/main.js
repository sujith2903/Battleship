(()=>{"use strict";const t=function(t,e){let n=0,r=!1;return{hit:function(){return n+=1,n},getHits:function(){return n},isSunk:function(){return n==t&&(r=!0),r},length:t,shipName:e}},e=function(){let e=function(){let t=[],e=[],n=[],r=[],i=[];function a(t,e){return 10*t+e}function o(t,e,n,i){let o=a(t,e);if("Horizontal"==i)for(let t=0;t<n.length;t++)if(r.includes(o+t))return!1;if("Vertical"==i)for(let t=0;t<n.length;t++)if(r.includes(o+10*t))return!1;return!("Horizontal"==i&&e+n.length>10||"Vertical"==i&&t+n.length>10)}return{createBoard:function(){for(let e=0;e<10;e++)for(let n=0;n<10;n++){let r={coordinates:void 0,name:void 0};r.coordinates=[e,n],r.name=null,t.push(r)}return t},getBoard:function(){return t},checkValidity:o,placeShip:function(e,n,s,l){if("Horizontal"==l&&o(e,n,s,l)){let i=a(e,n);for(let e=0;e<s.length;e++)t[i+e].name=s.shipName,r.push(i+e),console.log(r)}if("Vertical"==l&&o(e,n,s,l)){let i=a(e,n);for(let e=0;e<s.length;e++)t[i+10*e].name=s.shipName,r.push(i+10*e),console.log(r)}i.push(s)},receiveAttack:function(r,o){let s=a(r,o);return null!=t[s].name?(n.push(s),function(t){for(let e=0;e<i.length;e++)if(i[e].shipName==t)return i[e]}(t[s].name).hit()):e.push(s),s},isAllSunk:function(){if(r.length==n.length)return!0},getMissedPositions:function(){return e},getAttackedPositions:function(){return n},getShipsPositions:function(){return r}}}(),n=[t(5,"Carrier"),t(4,"Battleship"),t(3,"Cruiser"),t(3,"Submarine"),t(2,"Destroyer")],r=[];return{randomAttack:function(){return[Math.floor(10*Math.random()),Math.floor(10*Math.random())]},getBoard:function(){return e},getShips:function(){return n},getShotCoordinates:function(){return r},createBoard:e.createBoard,getBoard:e.getBoard,placeShip:e.placeShip,checkValidity:e.checkValidity,receiveAttack:e.receiveAttack,isAllSunk:e.isAllSunk,getMissedPositions:e.getMissedPositions,getAttackedPositions:e.getAttackedPositions,getShipsPositions:e.getShipsPositions}},n=function(){let t=e(),n=e();t.createBoard(),n.createBoard();let r=t.getBoard(),i=n.getBoard(),a=t.getShips(),o=n.getShips();return{gamer:t,computer:n,getGamerBoard:function(){return r},getComputerBoard:function(){return i},getGamerShips:function(){return a},getComputerShips:function(){return o}}}();(function(){const t=document.querySelector(".display"),e=document.querySelector(".player-board"),r=document.querySelector(".computer-board"),i=document.querySelector(".direction");let a=n.getGamerBoard(),o=n.getComputerBoard(),s=[...n.getGamerShips()];function l(t){let e=t.classList[1].split(",");return[parseInt(e[0]),parseInt(e[1])]}return n.getComputerShips(),window.addEventListener("load",(()=>{t.textContent="Welcome to Battleship. Place your Carrier"})),window.addEventListener("click",(()=>{switch(s.length){case 4:t.textContent="Place your Battleship";break;case 3:t.textContent="Place your Cruiser";break;case 2:t.textContent="Place your Submarine";break;case 1:t.textContent="Place your Destroyer";break;default:t.textContent="hey"}})),function(){let t,r,o=s[0];e.addEventListener("click",(c=>{if(c.target.classList.contains("player-board")){let u=c.target;if(t=l(u)[0],r=l(u)[1],s.length>0&&n.gamer.checkValidity(t,r,o,i.value)){n.gamer.placeShip(t,r,o,i.value),s.shift(),o=s[0];let l=n.gamer.getShipsPositions();for(let t=0;t<l.length;t++)e.children[l[t]].classList.add("ship");console.log(a)}}})),e.addEventListener("mouseover",(e=>{if(e.target.classList.contains("grid")){let a=e.target;t=l(a)[0],r=l(a)[1],s.length>0&&n.gamer.checkValidity(t,r,o,i.value)?a.classList.add("green"):s.length>0&&a.classList.add("red")}})),e.addEventListener("mouseout",(t=>{if(t.target.classList.contains("grid")){(e=t.target).classList.remove("green"),e.classList.remove("red")}var e}))}(),i.addEventListener("click",(()=>{"Horizontal"==i.value?(i.value="Vertical",i.textContent="Set Horizontal"):(i.value="Horizontal",i.textContent="Set Vertical")})),{hideDisplay:function(t){t.classList.remove("show"),t.classList.add("hide")},showDisplay:function(t){t.classList.remove("hide"),t.classList.add("show")},createGameBoards:function(){for(let t=0;t<a.length;t++){let n=document.createElement("div");n.classList.add(t),n.classList.add(a[t].coordinates),n.classList.add("grid"),n.classList.add("player-board"),e.appendChild(n)}for(let t=0;t<o.length;t++){let e=document.createElement("div");e.classList.add(t),e.classList.add(o[t].coordinates),e.classList.add("grid"),e.classList.add("computer-board"),r.appendChild(e)}}}})().createGameBoards()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQUEsTUE4QkEsRUE5QmEsU0FBVUEsRUFBUUMsR0FDN0IsSUFBSUMsRUFBTyxFQUNQQyxHQUFPLEVBbUJYLE1BQU8sQ0FDTEMsSUFqQkYsV0FFRSxPQURBRixHQUFRLEVBQ0RBLENBQ1QsRUFlRUcsUUFORixXQUNFLE9BQU9ILENBQ1QsRUFLRUksT0FkRixXQUlFLE9BSElKLEdBQVFGLElBQ1ZHLEdBQU8sR0FFRkEsQ0FDVCxFQVVFSCxTQUNBTyxTQXZCYU4sRUF5QmpCLEVDcUJBLEVBOUNlLFdBQ2IsSUFBSU8sRUNIWSxXQUNoQixJQUFJQSxFQUFRLEdBQ1JDLEVBQWUsR0FDZkMsRUFBbUIsR0FDbkJDLEVBQWUsR0FDZkMsRUFBUSxHQU1aLFNBQVNDLEVBQVlDLEVBQU1DLEdBRXpCLE9BRG1CLEdBQVBELEVBQVlDLENBRTFCLENBY0EsU0FBU0MsRUFBY0YsRUFBTUMsRUFBTUUsRUFBTUMsR0FDdkMsSUFBSUMsRUFBUU4sRUFBWUMsRUFBTUMsR0FFOUIsR0FBaUIsY0FBYkcsRUFDRixJQUFLLElBQUlFLEVBQUksRUFBR0EsRUFBSUgsRUFBS2pCLE9BQVFvQixJQUMvQixHQUFJVCxFQUFhVSxTQUFTRixFQUFRQyxHQUNoQyxPQUFPLEVBS2IsR0FBaUIsWUFBYkYsRUFDRixJQUFLLElBQUlFLEVBQUksRUFBR0EsRUFBSUgsRUFBS2pCLE9BQVFvQixJQUMvQixHQUFJVCxFQUFhVSxTQUFTRixFQUFZLEdBQUpDLEdBQ2hDLE9BQU8sRUFLYixRQUFpQixjQUFiRixHQUE2QkgsRUFBT0UsRUFBS2pCLE9BQVMsSUFJckMsWUFBYmtCLEdBQTJCSixFQUFPRyxFQUFLakIsT0FBUyxHQUl0RCxDQXFFQSxNQUFPLENBQ0xzQixZQTdHRixXQUNFLElBQUssSUFBSUYsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLElBQ3RCLElBQUssSUFBSUcsRUFBSSxFQUFHQSxFQUFJLEdBQUlBLElBQUssQ0FDM0IsSUFBSUMsRUFYRCxDQUFFQyxpQkFXZ0JDLEVBWEh6QixVQVdHeUIsR0FDckJGLEVBQWVDLFlBQWMsQ0FBQ0wsRUFBR0csR0FDakNDLEVBQWV2QixLQUFPLEtBQ3RCTyxFQUFNbUIsS0FBS0gsRUFDYixDQUVGLE9BQU9oQixDQUNULEVBb0dFb0IsU0FqQkYsV0FDRSxPQUFPcEIsQ0FDVCxFQWdCRVEsZ0JBQ0FhLFVBdkVGLFNBQW1CZixFQUFNQyxFQUFNRSxFQUFNQyxHQUNuQyxHQUNlLGNBQWJBLEdBQ0FGLEVBQWNGLEVBQU1DLEVBQU1FLEVBQU1DLEdBQ2hDLENBQ0EsSUFBSUMsRUFBUU4sRUFBWUMsRUFBTUMsR0FFOUIsSUFBSyxJQUFJSyxFQUFJLEVBQUdBLEVBQUlILEVBQUtqQixPQUFRb0IsSUFDL0JaLEVBQU1XLEVBQVFDLEdBQUduQixLQUFPZ0IsRUFBS1YsU0FDN0JJLEVBQWFnQixLQUFLUixFQUFRQyxHQUMxQlUsUUFBUUMsSUFBSXBCLEVBRWhCLENBRUEsR0FBaUIsWUFBYk8sR0FBMkJGLEVBQWNGLEVBQU1DLEVBQU1FLEVBQU1DLEdBQVksQ0FDekUsSUFBSUMsRUFBUU4sRUFBWUMsRUFBTUMsR0FFOUIsSUFBSyxJQUFJSyxFQUFJLEVBQUdBLEVBQUlILEVBQUtqQixPQUFRb0IsSUFDL0JaLEVBQU1XLEVBQVksR0FBSkMsR0FBUW5CLEtBQU9nQixFQUFLVixTQUNsQ0ksRUFBYWdCLEtBQUtSLEVBQVksR0FBSkMsR0FDMUJVLFFBQVFDLElBQUlwQixFQUVoQixDQUNBQyxFQUFNZSxLQUFLVixFQUNiLEVBZ0RFZSxjQTlDRixTQUF1QmxCLEVBQU1DLEdBQzNCLElBQUlJLEVBQVFOLEVBQVlDLEVBQU1DLEdBUTlCLE9BTnlCLE1BQXJCUCxFQUFNVyxHQUFPbEIsTUFDZlMsRUFBaUJpQixLQUFLUixHQVExQixTQUFrQmxCLEdBQ2hCLElBQUssSUFBSW1CLEVBQUksRUFBR0EsRUFBSVIsRUFBTVosT0FBUW9CLElBQ2hDLEdBQUlSLEVBQU1RLEdBQUdiLFVBQVlOLEVBQ3ZCLE9BQU9XLEVBQU1RLEVBR25CLENBYklhLENBQVN6QixFQUFNVyxHQUFPbEIsTUFBTUcsT0FFNUJLLEVBQWFrQixLQUFLUixHQUViQSxDQUNULEVBcUNFZSxVQTNCRixXQUNFLEdBQUl2QixFQUFhWCxRQUFVVSxFQUFpQlYsT0FDMUMsT0FBTyxDQUVYLEVBd0JFbUMsbUJBbEJGLFdBQ0UsT0FBTzFCLENBQ1QsRUFpQkUyQixxQkFYRixXQUNFLE9BQU8xQixDQUNULEVBVUUyQixrQkFoQkYsV0FDRSxPQUFPMUIsQ0FDVCxFQWdCRixDRHBJYyxHQU1SQyxFQUFRLENBTEUsRUFBSyxFQUFHLFdBQ0wsRUFBSyxFQUFHLGNBQ1gsRUFBSyxFQUFHLFdBQ04sRUFBSyxFQUFHLGFBQ1IsRUFBSyxFQUFHLGNBRXBCMEIsRUFBa0IsR0FxQnRCLE1BQU8sQ0FDTEMsYUFwQkYsV0FJRSxNQUFPLENBSENDLEtBQUtDLE1BQXNCLEdBQWhCRCxLQUFLRSxVQUNoQkYsS0FBS0MsTUFBc0IsR0FBaEJELEtBQUtFLFVBRzFCLEVBZ0JFZCxTQWRGLFdBQ0UsT0FBT3BCLENBQ1QsRUFhRW1DLFNBWEYsV0FDRSxPQUFPL0IsQ0FDVCxFQVVFZ0MsbUJBUkYsV0FDRSxPQUFPTixDQUNULEVBT0VoQixZQUFhZCxFQUFNYyxZQUNuQk0sU0FBVXBCLEVBQU1vQixTQUNoQkMsVUFBV3JCLEVBQU1xQixVQUNqQmIsY0FBZVIsRUFBTVEsY0FDckJnQixjQUFleEIsRUFBTXdCLGNBQ3JCRSxVQUFXMUIsRUFBTTBCLFVBQ2pCQyxtQkFBb0IzQixFQUFNMkIsbUJBQzFCQyxxQkFBc0I1QixFQUFNNEIscUJBQzVCQyxrQkFBbUI3QixFQUFNNkIsa0JBRTdCLEVFTEEsRUF0Q2EsV0FDWCxJQUFJUSxFQUFRLElBQ1JDLEVBQVcsSUFFZkQsRUFBTXZCLGNBQ053QixFQUFTeEIsY0FFVCxJQUFJeUIsRUFBYUYsRUFBTWpCLFdBQ25Cb0IsRUFBZ0JGLEVBQVNsQixXQUN6QnFCLEVBQWFKLEVBQU1GLFdBQ25CTyxFQUFnQkosRUFBU0gsV0FrQjdCLE1BQU8sQ0FDTEUsUUFDQUMsV0FDQUssY0FuQkYsV0FDRSxPQUFPSixDQUNULEVBa0JFSyxpQkFoQkYsV0FDRSxPQUFPSixDQUNULEVBZUVLLGNBYkYsV0FDRSxPQUFPSixDQUNULEVBWUVLLGlCQVZGLFdBQ0UsT0FBT0osQ0FDVCxFQVVELENBcENZLElDQ0QsV0FDVixNQUFNSyxFQUFVQyxTQUFTQyxjQUFjLFlBQ2pDQyxFQUFpQkYsU0FBU0MsY0FBYyxpQkFDeENFLEVBQW1CSCxTQUFTQyxjQUFjLG1CQUMxQ0csRUFBa0JKLFNBQVNDLGNBQWMsY0FFL0MsSUFBSVYsRUFBYSxFQUFLSSxnQkFDbEJILEVBQWdCLEVBQUtJLG1CQUNyQkgsRUFBYSxJQUFJLEVBQUtJLGlCQWdDMUIsU0FBU1EsRUFBZUMsR0FDdEIsSUFBSXJDLEVBQWNxQyxFQUFPQyxVQUFVLEdBQUdDLE1BQU0sS0FJNUMsTUFBTyxDQUhJQyxTQUFTeEMsRUFBWSxJQUNyQndDLFNBQVN4QyxFQUFZLElBR2xDLENBK0dBLE9BcEp3QixFQUFLNkIsbUJBcUQzQlksT0FBT0MsaUJBQWlCLFFBQVEsS0FDOUJaLEVBQVFhLFlBQWMsMkNBQTJDLElBR25FRixPQUFPQyxpQkFBaUIsU0FBUyxLQUMvQixPQUFRbEIsRUFBV2pELFFBQ2pCLEtBQUssRUFDSHVELEVBQVFhLFlBQWMsd0JBQ3RCLE1BQ0YsS0FBSyxFQUNIYixFQUFRYSxZQUFjLHFCQUN0QixNQUNGLEtBQUssRUFDSGIsRUFBUWEsWUFBYyx1QkFDdEIsTUFDRixLQUFLLEVBQ0hiLEVBQVFhLFlBQWMsdUJBQ3RCLE1BRUYsUUFDRWIsRUFBUWEsWUFBYyxNQUMxQixJQUlKLFdBQ0UsSUFDSXRELEVBQ0FDLEVBRkFzRCxFQUFjcEIsRUFBVyxHQUk3QlMsRUFBZVMsaUJBQWlCLFNBQVVHLElBQ3hDLEdBQUlBLEVBQUtSLE9BQU9DLFVBQVVRLFNBQVMsZ0JBQWlCLENBQ2xELElBQUlULEVBQVNRLEVBQUtSLE9BR2xCLEdBRkFoRCxFQUFPK0MsRUFBZUMsR0FBUSxHQUM5Qi9DLEVBQU84QyxFQUFlQyxHQUFRLEdBRTVCYixFQUFXakQsT0FBUyxHQUNwQixFQUFLNkMsTUFBTTdCLGNBQ1RGLEVBQ0FDLEVBQ0FzRCxFQUNBVCxFQUFnQlksT0FFbEIsQ0FDQSxFQUFLM0IsTUFBTWhCLFVBQVVmLEVBQU1DLEVBQU1zRCxFQUFhVCxFQUFnQlksT0FDOUR2QixFQUFXd0IsUUFDWEosRUFBY3BCLEVBQVcsR0FDekIsSUFBSXlCLEVBQWdCLEVBQUs3QixNQUFNUixvQkFDL0IsSUFBSyxJQUFJakIsRUFBSSxFQUFHQSxFQUFJc0QsRUFBYzFFLE9BQVFvQixJQUN4Q3NDLEVBQWVpQixTQUFTRCxFQUFjdEQsSUFBSTJDLFVBQVVhLElBQUksUUFFMUQ5QyxRQUFRQyxJQUFJZ0IsRUFDZCxDQUNGLEtBR0ZXLEVBQWVTLGlCQUFpQixhQUFjRyxJQUM1QyxHQUFJQSxFQUFLUixPQUFPQyxVQUFVUSxTQUFTLFFBQVMsQ0FDMUMsSUFBSVQsRUFBU1EsRUFBS1IsT0FDbEJoRCxFQUFPK0MsRUFBZUMsR0FBUSxHQUM5Qi9DLEVBQU84QyxFQUFlQyxHQUFRLEdBRTVCYixFQUFXakQsT0FBUyxHQUNwQixFQUFLNkMsTUFBTTdCLGNBQ1RGLEVBQ0FDLEVBQ0FzRCxFQUNBVCxFQUFnQlksT0FHRFYsRUFuRmxCQyxVQUFVYSxJQUFJLFNBb0ZKM0IsRUFBV2pELE9BQVMsR0FDVDhELEVBNUVyQkMsVUFBVWEsSUFBSSxNQThFakIsS0FHRmxCLEVBQWVTLGlCQUFpQixZQUFhRyxJQUMzQyxHQUFJQSxFQUFLUixPQUFPQyxVQUFVUSxTQUFTLFFBQVMsRUF4Rm5CTSxFQXlGVlAsRUFBS1IsUUF4RmpCQyxVQUFVZSxPQUFPLFNBQ3RCRCxFQUFLZCxVQUFVZSxPQUFPLE1BeUZwQixDQTNGSixJQUE2QkQsQ0EyRnpCLEdBRUgsQ0ExREQsR0E0REFqQixFQUFnQk8saUJBQWlCLFNBQVMsS0FDWCxjQUF6QlAsRUFBZ0JZLE9BQ2xCWixFQUFnQlksTUFBUSxXQUN4QlosRUFBZ0JRLFlBQWMsbUJBRTlCUixFQUFnQlksTUFBUSxhQUN4QlosRUFBZ0JRLFlBQWMsZUFDaEMsSUFHSyxDQUNMVyxZQW5KRixTQUFxQkMsR0FDbkJBLEVBQVFqQixVQUFVZSxPQUFPLFFBQ3pCRSxFQUFRakIsVUFBVWEsSUFBSSxPQUN4QixFQWlKRUssWUEvSUYsU0FBcUJELEdBQ25CQSxFQUFRakIsVUFBVWUsT0FBTyxRQUN6QkUsRUFBUWpCLFVBQVVhLElBQUksT0FDeEIsRUE2SUVNLGlCQTNJRixXQUNFLElBQUssSUFBSTlELEVBQUksRUFBR0EsRUFBSTJCLEVBQVcvQyxPQUFRb0IsSUFBSyxDQUMxQyxJQUFJa0QsRUFBT2QsU0FBUzJCLGNBQWMsT0FDbENiLEVBQUtQLFVBQVVhLElBQUl4RCxHQUNuQmtELEVBQUtQLFVBQVVhLElBQUk3QixFQUFXM0IsR0FBR0ssYUFDakM2QyxFQUFLUCxVQUFVYSxJQUFJLFFBQ25CTixFQUFLUCxVQUFVYSxJQUFJLGdCQUNuQmxCLEVBQWUwQixZQUFZZCxFQUM3QixDQUNBLElBQUssSUFBSWxELEVBQUksRUFBR0EsRUFBSTRCLEVBQWNoRCxPQUFRb0IsSUFBSyxDQUM3QyxJQUFJa0QsRUFBT2QsU0FBUzJCLGNBQWMsT0FDbENiLEVBQUtQLFVBQVVhLElBQUl4RCxHQUNuQmtELEVBQUtQLFVBQVVhLElBQUk1QixFQUFjNUIsR0FBR0ssYUFDcEM2QyxFQUFLUCxVQUFVYSxJQUFJLFFBQ25CTixFQUFLUCxVQUFVYSxJQUFJLGtCQUNuQmpCLEVBQWlCeUIsWUFBWWQsRUFDL0IsQ0FDRixFQTRIRCxFQWxLVyxHQ0NSWSxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9kb20uanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzaGlwID0gZnVuY3Rpb24gKGxlbmd0aCwgbmFtZSkge1xuICBsZXQgaGl0cyA9IDA7XG4gIGxldCBzdW5rID0gZmFsc2U7XG4gIGxldCBzaGlwTmFtZSA9IG5hbWU7XG5cbiAgZnVuY3Rpb24gaGl0KCkge1xuICAgIGhpdHMgKz0gMTtcbiAgICByZXR1cm4gaGl0cztcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzU3VuaygpIHtcbiAgICBpZiAoaGl0cyA9PSBsZW5ndGgpIHtcbiAgICAgIHN1bmsgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gc3VuaztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEhpdHMoKSB7XG4gICAgcmV0dXJuIGhpdHM7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGhpdCxcbiAgICBnZXRIaXRzLFxuICAgIGlzU3VuayxcbiAgICBsZW5ndGgsXG4gICAgc2hpcE5hbWUsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzaGlwO1xuIiwiaW1wb3J0IHNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuY29uc3QgcGxheWVyID0gZnVuY3Rpb24gKCkge1xuICBsZXQgYm9hcmQgPSBnYW1lQm9hcmQoKTtcbiAgbGV0IGNhcnJpZXIgPSBzaGlwKDUsIFwiQ2FycmllclwiKTtcbiAgbGV0IGJhdHRsZXNoaXAgPSBzaGlwKDQsIFwiQmF0dGxlc2hpcFwiKTtcbiAgbGV0IGNydWlzZXIgPSBzaGlwKDMsIFwiQ3J1aXNlclwiKTtcbiAgbGV0IHN1Ym1hcmluZSA9IHNoaXAoMywgXCJTdWJtYXJpbmVcIik7XG4gIGxldCBkZXN0cm95ZXIgPSBzaGlwKDIsIFwiRGVzdHJveWVyXCIpO1xuICBsZXQgc2hpcHMgPSBbY2FycmllciwgYmF0dGxlc2hpcCwgY3J1aXNlciwgc3VibWFyaW5lLCBkZXN0cm95ZXJdO1xuICBsZXQgc2hvdENvb3JkaW5hdGVzID0gW107XG5cbiAgZnVuY3Rpb24gcmFuZG9tQXR0YWNrKCkge1xuICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuXG4gICAgcmV0dXJuIFt4LCB5XTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEJvYXJkKCkge1xuICAgIHJldHVybiBib2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFNoaXBzKCkge1xuICAgIHJldHVybiBzaGlwcztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFNob3RDb29yZGluYXRlcygpIHtcbiAgICByZXR1cm4gc2hvdENvb3JkaW5hdGVzO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICByYW5kb21BdHRhY2ssXG4gICAgZ2V0Qm9hcmQsXG4gICAgZ2V0U2hpcHMsXG4gICAgZ2V0U2hvdENvb3JkaW5hdGVzLFxuICAgIGNyZWF0ZUJvYXJkOiBib2FyZC5jcmVhdGVCb2FyZCxcbiAgICBnZXRCb2FyZDogYm9hcmQuZ2V0Qm9hcmQsXG4gICAgcGxhY2VTaGlwOiBib2FyZC5wbGFjZVNoaXAsXG4gICAgY2hlY2tWYWxpZGl0eTogYm9hcmQuY2hlY2tWYWxpZGl0eSxcbiAgICByZWNlaXZlQXR0YWNrOiBib2FyZC5yZWNlaXZlQXR0YWNrLFxuICAgIGlzQWxsU3VuazogYm9hcmQuaXNBbGxTdW5rLFxuICAgIGdldE1pc3NlZFBvc2l0aW9uczogYm9hcmQuZ2V0TWlzc2VkUG9zaXRpb25zLFxuICAgIGdldEF0dGFja2VkUG9zaXRpb25zOiBib2FyZC5nZXRBdHRhY2tlZFBvc2l0aW9ucyxcbiAgICBnZXRTaGlwc1Bvc2l0aW9uczogYm9hcmQuZ2V0U2hpcHNQb3NpdGlvbnMsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBwbGF5ZXI7XG4iLCJpbXBvcnQgc2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5jb25zdCBnYW1lQm9hcmQgPSBmdW5jdGlvbiAoKSB7XG4gIGxldCBib2FyZCA9IFtdO1xuICBsZXQgbWlzc2VkQXR0YWNrID0gW107XG4gIGxldCBhdHRhY2tlZFBvc2l0aW9uID0gW107XG4gIGxldCBzaGlwUG9zaXRpb24gPSBbXTtcbiAgbGV0IHNoaXBzID0gW107XG5cbiAgZnVuY3Rpb24gY3JlYXRlQ29vcmRpbmF0ZShjb29yZGluYXRlcywgbmFtZSkge1xuICAgIHJldHVybiB7IGNvb3JkaW5hdGVzLCBuYW1lIH07XG4gIH1cblxuICBmdW5jdGlvbiBpbmRleEZpbmRlcihwb3MxLCBwb3MyKSB7XG4gICAgbGV0IGluZGV4ID0gcG9zMSAqIDEwICsgcG9zMjtcbiAgICByZXR1cm4gaW5kZXg7XG4gIH1cblxuICBmdW5jdGlvbiBjcmVhdGVCb2FyZCgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICBsZXQgbmV3Q29vcmRpbmF0ZXMgPSBjcmVhdGVDb29yZGluYXRlKCk7XG4gICAgICAgIG5ld0Nvb3JkaW5hdGVzLmNvb3JkaW5hdGVzID0gW2ksIGpdO1xuICAgICAgICBuZXdDb29yZGluYXRlcy5uYW1lID0gbnVsbDtcbiAgICAgICAgYm9hcmQucHVzaChuZXdDb29yZGluYXRlcyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBib2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNoZWNrVmFsaWRpdHkocG9zMSwgcG9zMiwgc2hpcCwgZGlyZWN0aW9uKSB7XG4gICAgbGV0IGluZGV4ID0gaW5kZXhGaW5kZXIocG9zMSwgcG9zMik7XG5cbiAgICBpZiAoZGlyZWN0aW9uID09IFwiSG9yaXpvbnRhbFwiKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHNoaXBQb3NpdGlvbi5pbmNsdWRlcyhpbmRleCArIGkpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcIlZlcnRpY2FsXCIpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoc2hpcFBvc2l0aW9uLmluY2x1ZGVzKGluZGV4ICsgaSAqIDEwKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJIb3Jpem9udGFsXCIgJiYgcG9zMiArIHNoaXAubGVuZ3RoID4gMTApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoZGlyZWN0aW9uID09IFwiVmVydGljYWxcIiAmJiBwb3MxICsgc2hpcC5sZW5ndGggPiAxMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYWNlU2hpcChwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pIHtcbiAgICBpZiAoXG4gICAgICBkaXJlY3Rpb24gPT0gXCJIb3Jpem9udGFsXCIgJiZcbiAgICAgIGNoZWNrVmFsaWRpdHkocG9zMSwgcG9zMiwgc2hpcCwgZGlyZWN0aW9uKVxuICAgICkge1xuICAgICAgbGV0IGluZGV4ID0gaW5kZXhGaW5kZXIocG9zMSwgcG9zMik7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBib2FyZFtpbmRleCArIGldLm5hbWUgPSBzaGlwLnNoaXBOYW1lO1xuICAgICAgICBzaGlwUG9zaXRpb24ucHVzaChpbmRleCArIGkpO1xuICAgICAgICBjb25zb2xlLmxvZyhzaGlwUG9zaXRpb24pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJWZXJ0aWNhbFwiICYmIGNoZWNrVmFsaWRpdHkocG9zMSwgcG9zMiwgc2hpcCwgZGlyZWN0aW9uKSkge1xuICAgICAgbGV0IGluZGV4ID0gaW5kZXhGaW5kZXIocG9zMSwgcG9zMik7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBib2FyZFtpbmRleCArIGkgKiAxMF0ubmFtZSA9IHNoaXAuc2hpcE5hbWU7XG4gICAgICAgIHNoaXBQb3NpdGlvbi5wdXNoKGluZGV4ICsgaSAqIDEwKTtcbiAgICAgICAgY29uc29sZS5sb2coc2hpcFBvc2l0aW9uKTtcbiAgICAgIH1cbiAgICB9XG4gICAgc2hpcHMucHVzaChzaGlwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlY2VpdmVBdHRhY2socG9zMSwgcG9zMikge1xuICAgIGxldCBpbmRleCA9IGluZGV4RmluZGVyKHBvczEsIHBvczIpO1xuXG4gICAgaWYgKGJvYXJkW2luZGV4XS5uYW1lICE9IG51bGwpIHtcbiAgICAgIGF0dGFja2VkUG9zaXRpb24ucHVzaChpbmRleCk7XG4gICAgICBmaW5kU2hpcChib2FyZFtpbmRleF0ubmFtZSkuaGl0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1pc3NlZEF0dGFjay5wdXNoKGluZGV4KTtcbiAgICB9XG4gICAgcmV0dXJuIGluZGV4O1xuICB9XG5cbiAgZnVuY3Rpb24gZmluZFNoaXAobmFtZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzaGlwc1tpXS5zaGlwTmFtZSA9PSBuYW1lKSB7XG4gICAgICAgIHJldHVybiBzaGlwc1tpXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBpc0FsbFN1bmsoKSB7XG4gICAgaWYgKHNoaXBQb3NpdGlvbi5sZW5ndGggPT0gYXR0YWNrZWRQb3NpdGlvbi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEJvYXJkKCkge1xuICAgIHJldHVybiBib2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldE1pc3NlZFBvc2l0aW9ucygpIHtcbiAgICByZXR1cm4gbWlzc2VkQXR0YWNrO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U2hpcHNQb3NpdGlvbnMoKSB7XG4gICAgcmV0dXJuIHNoaXBQb3NpdGlvbjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEF0dGFja2VkUG9zaXRpb25zKCkge1xuICAgIHJldHVybiBhdHRhY2tlZFBvc2l0aW9uO1xuICB9XG4gIHJldHVybiB7XG4gICAgY3JlYXRlQm9hcmQsXG4gICAgZ2V0Qm9hcmQsXG4gICAgY2hlY2tWYWxpZGl0eSxcbiAgICBwbGFjZVNoaXAsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBpc0FsbFN1bmssXG4gICAgZ2V0TWlzc2VkUG9zaXRpb25zLFxuICAgIGdldEF0dGFja2VkUG9zaXRpb25zLFxuICAgIGdldFNoaXBzUG9zaXRpb25zLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZ2FtZUJvYXJkO1xuIiwiaW1wb3J0IHNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBwbGF5ZXIgZnJvbSBcIi4vcGxheWVyXCI7XG5cbmNvbnN0IGdhbWUgPSAoZnVuY3Rpb24gKCkge1xuICBsZXQgZ2FtZXIgPSBwbGF5ZXIoKTtcbiAgbGV0IGNvbXB1dGVyID0gcGxheWVyKCk7XG5cbiAgZ2FtZXIuY3JlYXRlQm9hcmQoKTtcbiAgY29tcHV0ZXIuY3JlYXRlQm9hcmQoKTtcblxuICBsZXQgZ2FtZXJCb2FyZCA9IGdhbWVyLmdldEJvYXJkKCk7XG4gIGxldCBjb21wdXRlckJvYXJkID0gY29tcHV0ZXIuZ2V0Qm9hcmQoKTtcbiAgbGV0IGdhbWVyU2hpcHMgPSBnYW1lci5nZXRTaGlwcygpO1xuICBsZXQgY29tcHV0ZXJTaGlwcyA9IGNvbXB1dGVyLmdldFNoaXBzKCk7XG5cbiAgZnVuY3Rpb24gZ2V0R2FtZXJCb2FyZCgpIHtcbiAgICByZXR1cm4gZ2FtZXJCb2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldENvbXB1dGVyQm9hcmQoKSB7XG4gICAgcmV0dXJuIGNvbXB1dGVyQm9hcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRHYW1lclNoaXBzKCkge1xuICAgIHJldHVybiBnYW1lclNoaXBzO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Q29tcHV0ZXJTaGlwcygpIHtcbiAgICByZXR1cm4gY29tcHV0ZXJTaGlwcztcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZ2FtZXIsXG4gICAgY29tcHV0ZXIsXG4gICAgZ2V0R2FtZXJCb2FyZCxcbiAgICBnZXRDb21wdXRlckJvYXJkLFxuICAgIGdldEdhbWVyU2hpcHMsXG4gICAgZ2V0Q29tcHV0ZXJTaGlwcyxcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGdhbWU7XG4iLCJpbXBvcnQgc2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgZ2FtZUJvYXJkIGZyb20gXCIuL2dhbWVib2FyZFwiO1xuaW1wb3J0IHBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCBnYW1lIGZyb20gXCIuL2dhbWVcIjtcblxuY29uc3QgZG9tID0gKGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgZGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlzcGxheVwiKTtcbiAgY29uc3QgcGxheWVyQm9hcmREaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllci1ib2FyZFwiKTtcbiAgY29uc3QgY29tcHV0ZXJCb2FyZERpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcHV0ZXItYm9hcmRcIik7XG4gIGNvbnN0IGRpcmVjdGlvbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlyZWN0aW9uXCIpO1xuXG4gIGxldCBnYW1lckJvYXJkID0gZ2FtZS5nZXRHYW1lckJvYXJkKCk7XG4gIGxldCBjb21wdXRlckJvYXJkID0gZ2FtZS5nZXRDb21wdXRlckJvYXJkKCk7XG4gIGxldCBnYW1lclNoaXBzID0gWy4uLmdhbWUuZ2V0R2FtZXJTaGlwcygpXTtcbiAgbGV0IGNvbXB1dGVyU2hpcHMgPSBbLi4uZ2FtZS5nZXRDb21wdXRlclNoaXBzKCldO1xuXG4gIGZ1bmN0aW9uIGhpZGVEaXNwbGF5KGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJzaG93XCIpO1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImhpZGVcIik7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93RGlzcGxheShlbGVtZW50KSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZVwiKTtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJzaG93XCIpO1xuICB9XG5cbiAgZnVuY3Rpb24gY3JlYXRlR2FtZUJvYXJkcygpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdhbWVyQm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBncmlkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChpKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChnYW1lckJvYXJkW2ldLmNvb3JkaW5hdGVzKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChcImdyaWRcIik7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoXCJwbGF5ZXItYm9hcmRcIik7XG4gICAgICBwbGF5ZXJCb2FyZERpdi5hcHBlbmRDaGlsZChncmlkKTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb21wdXRlckJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgZ3JpZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoaSk7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoY29tcHV0ZXJCb2FyZFtpXS5jb29yZGluYXRlcyk7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoXCJncmlkXCIpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKFwiY29tcHV0ZXItYm9hcmRcIik7XG4gICAgICBjb21wdXRlckJvYXJkRGl2LmFwcGVuZENoaWxkKGdyaWQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldENvb3JkaW5hdGVzKHRhcmdldCkge1xuICAgIGxldCBjb29yZGluYXRlcyA9IHRhcmdldC5jbGFzc0xpc3RbMV0uc3BsaXQoXCIsXCIpO1xuICAgIGxldCBwb3MxID0gcGFyc2VJbnQoY29vcmRpbmF0ZXNbMF0pO1xuICAgIGxldCBwb3MyID0gcGFyc2VJbnQoY29vcmRpbmF0ZXNbMV0pO1xuXG4gICAgcmV0dXJuIFtwb3MxLCBwb3MyXTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZFZhbGlkaXR5Q29sb3IoY2VsbCkge1xuICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcImdyZWVuXCIpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlVmFsaWRpdHlDb2xvcihjZWxsKSB7XG4gICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKFwiZ3JlZW5cIik7XG4gICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKFwicmVkXCIpO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkTm9uVmFsaWRpdHlDb2xvcihjZWxsKSB7XG4gICAgY2VsbC5jbGFzc0xpc3QuYWRkKFwicmVkXCIpO1xuICB9XG5cbiAgKGZ1bmN0aW9uIGRpc3BsYXlFdmVudHMoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IHtcbiAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBcIldlbGNvbWUgdG8gQmF0dGxlc2hpcC4gUGxhY2UgeW91ciBDYXJyaWVyXCI7XG4gICAgfSk7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHN3aXRjaCAoZ2FtZXJTaGlwcy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgQmF0dGxlc2hpcFwiO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IFwiUGxhY2UgeW91ciBDcnVpc2VyXCI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgICBkaXNwbGF5LnRleHRDb250ZW50ID0gXCJQbGFjZSB5b3VyIFN1Ym1hcmluZVwiO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IFwiUGxhY2UgeW91ciBEZXN0cm95ZXJcIjtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBcImhleVwiO1xuICAgICAgfVxuICAgIH0pO1xuICB9KSgpO1xuXG4gIChmdW5jdGlvbiBwbGF5ZXJCb2FyZEV2ZW50cygpIHtcbiAgICBsZXQgY3VycmVudFNoaXAgPSBnYW1lclNoaXBzWzBdO1xuICAgIGxldCBwb3MxO1xuICAgIGxldCBwb3MyO1xuXG4gICAgcGxheWVyQm9hcmREaXYuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChncmlkKSA9PiB7XG4gICAgICBpZiAoZ3JpZC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicGxheWVyLWJvYXJkXCIpKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgcG9zMSA9IGdldENvb3JkaW5hdGVzKHRhcmdldClbMF07XG4gICAgICAgIHBvczIgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzFdO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgZ2FtZXJTaGlwcy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgZ2FtZS5nYW1lci5jaGVja1ZhbGlkaXR5KFxuICAgICAgICAgICAgcG9zMSxcbiAgICAgICAgICAgIHBvczIsXG4gICAgICAgICAgICBjdXJyZW50U2hpcCxcbiAgICAgICAgICAgIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZVxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgZ2FtZS5nYW1lci5wbGFjZVNoaXAocG9zMSwgcG9zMiwgY3VycmVudFNoaXAsIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZSk7XG4gICAgICAgICAgZ2FtZXJTaGlwcy5zaGlmdCgpO1xuICAgICAgICAgIGN1cnJlbnRTaGlwID0gZ2FtZXJTaGlwc1swXTtcbiAgICAgICAgICBsZXQgc2hpcFBvc2l0aW9ucyA9IGdhbWUuZ2FtZXIuZ2V0U2hpcHNQb3NpdGlvbnMoKTtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW3NoaXBQb3NpdGlvbnNbaV1dLmNsYXNzTGlzdC5hZGQoXCJzaGlwXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zb2xlLmxvZyhnYW1lckJvYXJkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcGxheWVyQm9hcmREaXYuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCAoZ3JpZCkgPT4ge1xuICAgICAgaWYgKGdyaWQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImdyaWRcIikpIHtcbiAgICAgICAgbGV0IHRhcmdldCA9IGdyaWQudGFyZ2V0O1xuICAgICAgICBwb3MxID0gZ2V0Q29vcmRpbmF0ZXModGFyZ2V0KVswXTtcbiAgICAgICAgcG9zMiA9IGdldENvb3JkaW5hdGVzKHRhcmdldClbMV07XG4gICAgICAgIGlmIChcbiAgICAgICAgICBnYW1lclNoaXBzLmxlbmd0aCA+IDAgJiZcbiAgICAgICAgICBnYW1lLmdhbWVyLmNoZWNrVmFsaWRpdHkoXG4gICAgICAgICAgICBwb3MxLFxuICAgICAgICAgICAgcG9zMixcbiAgICAgICAgICAgIGN1cnJlbnRTaGlwLFxuICAgICAgICAgICAgZGlyZWN0aW9uQnV0dG9uLnZhbHVlXG4gICAgICAgICAgKVxuICAgICAgICApIHtcbiAgICAgICAgICBhZGRWYWxpZGl0eUNvbG9yKHRhcmdldCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZ2FtZXJTaGlwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgYWRkTm9uVmFsaWRpdHlDb2xvcih0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBwbGF5ZXJCb2FyZERpdi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgKGdyaWQpID0+IHtcbiAgICAgIGlmIChncmlkLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJncmlkXCIpKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgcmVtb3ZlVmFsaWRpdHlDb2xvcih0YXJnZXQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KSgpO1xuXG4gIGRpcmVjdGlvbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGlmIChkaXJlY3Rpb25CdXR0b24udmFsdWUgPT0gXCJIb3Jpem9udGFsXCIpIHtcbiAgICAgIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZSA9IFwiVmVydGljYWxcIjtcbiAgICAgIGRpcmVjdGlvbkJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2V0IEhvcml6b250YWxcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgZGlyZWN0aW9uQnV0dG9uLnZhbHVlID0gXCJIb3Jpem9udGFsXCI7XG4gICAgICBkaXJlY3Rpb25CdXR0b24udGV4dENvbnRlbnQgPSBcIlNldCBWZXJ0aWNhbFwiO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICBoaWRlRGlzcGxheSxcbiAgICBzaG93RGlzcGxheSxcbiAgICBjcmVhdGVHYW1lQm9hcmRzLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgZG9tO1xuIiwiaW1wb3J0IGRvbSBmcm9tIFwiLi9kb21cIjtcbmltcG9ydCBzaGlwIGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCBnYW1lQm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5pbXBvcnQgcGxheWVyIGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IGdhbWUgZnJvbSBcIi4vZ2FtZVwiO1xuXG5kb20uY3JlYXRlR2FtZUJvYXJkcygpO1xuIl0sIm5hbWVzIjpbImxlbmd0aCIsIm5hbWUiLCJoaXRzIiwic3VuayIsImhpdCIsImdldEhpdHMiLCJpc1N1bmsiLCJzaGlwTmFtZSIsImJvYXJkIiwibWlzc2VkQXR0YWNrIiwiYXR0YWNrZWRQb3NpdGlvbiIsInNoaXBQb3NpdGlvbiIsInNoaXBzIiwiaW5kZXhGaW5kZXIiLCJwb3MxIiwicG9zMiIsImNoZWNrVmFsaWRpdHkiLCJzaGlwIiwiZGlyZWN0aW9uIiwiaW5kZXgiLCJpIiwiaW5jbHVkZXMiLCJjcmVhdGVCb2FyZCIsImoiLCJuZXdDb29yZGluYXRlcyIsImNvb3JkaW5hdGVzIiwiY3JlYXRlQ29vcmRpbmF0ZSIsInB1c2giLCJnZXRCb2FyZCIsInBsYWNlU2hpcCIsImNvbnNvbGUiLCJsb2ciLCJyZWNlaXZlQXR0YWNrIiwiZmluZFNoaXAiLCJpc0FsbFN1bmsiLCJnZXRNaXNzZWRQb3NpdGlvbnMiLCJnZXRBdHRhY2tlZFBvc2l0aW9ucyIsImdldFNoaXBzUG9zaXRpb25zIiwic2hvdENvb3JkaW5hdGVzIiwicmFuZG9tQXR0YWNrIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiZ2V0U2hpcHMiLCJnZXRTaG90Q29vcmRpbmF0ZXMiLCJnYW1lciIsImNvbXB1dGVyIiwiZ2FtZXJCb2FyZCIsImNvbXB1dGVyQm9hcmQiLCJnYW1lclNoaXBzIiwiY29tcHV0ZXJTaGlwcyIsImdldEdhbWVyQm9hcmQiLCJnZXRDb21wdXRlckJvYXJkIiwiZ2V0R2FtZXJTaGlwcyIsImdldENvbXB1dGVyU2hpcHMiLCJkaXNwbGF5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicGxheWVyQm9hcmREaXYiLCJjb21wdXRlckJvYXJkRGl2IiwiZGlyZWN0aW9uQnV0dG9uIiwiZ2V0Q29vcmRpbmF0ZXMiLCJ0YXJnZXQiLCJjbGFzc0xpc3QiLCJzcGxpdCIsInBhcnNlSW50Iiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRleHRDb250ZW50IiwiY3VycmVudFNoaXAiLCJncmlkIiwiY29udGFpbnMiLCJ2YWx1ZSIsInNoaWZ0Iiwic2hpcFBvc2l0aW9ucyIsImNoaWxkcmVuIiwiYWRkIiwiY2VsbCIsInJlbW92ZSIsImhpZGVEaXNwbGF5IiwiZWxlbWVudCIsInNob3dEaXNwbGF5IiwiY3JlYXRlR2FtZUJvYXJkcyIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCJdLCJzb3VyY2VSb290IjoiIn0=