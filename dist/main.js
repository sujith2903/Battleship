(()=>{"use strict";const e=function(e,t){let n=0,i=!1;return{hit:function(){return n+=1,n},getHits:function(){return n},isSunk:function(){return n==e&&(i=!0),i},length:e,shipName:t}},t=function(){let t=function(){let e=[],t=[],n=[],i=[],r=[];function o(e,t){return 10*e+t}function a(e,t,n,r){let a=o(e,t);if("Horizontal"==r)for(let e=0;e<n.length;e++)if(i.includes(a+e))return!1;if("Vertical"==r)for(let e=0;e<n.length;e++)if(i.includes(a+10*e))return!1;return!("Horizontal"==r&&t+n.length>10||"Vertical"==r&&e+n.length>10)}return{createBoard:function(){for(let t=0;t<10;t++)for(let n=0;n<10;n++){let i={coordinates:void 0,name:void 0};i.coordinates=[t,n],i.name=null,e.push(i)}return e},getBoard:function(){return e},checkValidity:a,placeShip:function(t,n,s,l){if("Horizontal"==l&&a(t,n,s,l)){let r=o(t,n);for(let t=0;t<s.length;t++)e[r+t].name=s.shipName,i.push(r+t)}if("Vertical"==l&&a(t,n,s,l)){let r=o(t,n);for(let t=0;t<s.length;t++)e[r+10*t].name=s.shipName,i.push(r+10*t)}r.push(s)},receiveAttack:function(i,a){let s=o(i,a);null!=e[s].name?n.includes(s)||(n.push(s),function(e){for(let t=0;t<r.length;t++)if(r[t].shipName==e)return r[t]}(e[s].name).hit()):t.includes(s)||t.push(s)},isAllSunk:function(){if(i.length==n.length)return!0},getMissedPositions:function(){return t},getAttackedPositions:function(){return n},getShipsPositions:function(){return i}}}(),n=[e(5,"Carrier"),e(4,"Battleship"),e(3,"Cruiser"),e(3,"Submarine"),e(2,"Destroyer")];function i(){return[Math.floor(10*Math.random()),Math.floor(10*Math.random())]}return{randomAttack:function e(t){let n=i(),r=n[0],o=n[1],a=function(e,t){return 10*e+t}(r,o);t.getShotCoordinates().includes(a)?e(t):t.receiveAttack(r,o)},randomPlacement:function e(n){let r=i(),o=r[0],a=r[1],s="";s=1==Math.floor(2*Math.random())?"Horizontal":"Vertical",t.checkValidity(o,a,n,s)?t.placeShip(o,a,n,s):e(n)},getBoard:function(){return t},getShips:function(){return n},getShotCoordinates:function(){return[...t.getAttackedPositions(),...t.getMissedPositions()]},createBoard:t.createBoard,getBoard:t.getBoard,placeShip:t.placeShip,checkValidity:t.checkValidity,receiveAttack:t.receiveAttack,isAllSunk:t.isAllSunk,getMissedPositions:t.getMissedPositions,getAttackedPositions:t.getAttackedPositions,getShipsPositions:t.getShipsPositions}},n=function(){let e=t(),n=t();e.createBoard(),n.createBoard();let i=e.getBoard(),r=n.getBoard(),o=e.getShips(),a=n.getShips(),s="Gamer",l="",c=[];return{gamer:e,computer:n,setInput:function(e){c=e},gameLoop:function(){"Gamer"==s&&(n.receiveAttack(c[0],c[1]),n.isAllSunk()?l="Gamer":(s="Computer",c=[])),"Computer"==s&&(n.randomAttack(e),e.isAllSunk()?l="Computer":s="Gamer"),console.log(l)},getTurn:function(){return s},getWinner:function(){return l},getGamerBoard:function(){return i},getComputerBoard:function(){return r},getGamerShips:function(){return o},getComputerShips:function(){return a}}}();(function(){const e=document.querySelector(".display"),t=document.querySelector(".player-board"),i=document.querySelector(".computer-board"),r=document.querySelector(".direction"),o=document.querySelector(".reset");let a=n.getGamerBoard(),s=n.getComputerBoard(),l=[...n.getGamerShips()],c=[...n.getComputerShips()];function d(e){let t=e.classList[1].split(",");return[parseInt(t[0]),parseInt(t[1])]}return window.addEventListener("load",(()=>{e.textContent="Welcome to Battleship. Place your Carrier"})),window.addEventListener("click",(()=>{switch(l.length){case 4:e.textContent="Place your Battleship";break;case 3:e.textContent="Place your Cruiser";break;case 2:e.textContent="Place your Submarine";break;case 1:e.textContent="Place your Destroyer";break;case 0:""==n.getWinner()?e.textContent=`${n.getTurn()}'s Turn`:e.textContent=`${n.getWinner()} Won`}})),function(){let e,i,o=l[0];t.addEventListener("click",(s=>{if(s.target.classList.contains("player-board")){let c=s.target;if(e=d(c)[0],i=d(c)[1],l.length>0&&n.gamer.checkValidity(e,i,o,r.value)){n.gamer.placeShip(e,i,o,r.value),l.shift(),o=l[0];let s=n.gamer.getShipsPositions();for(let e=0;e<s.length;e++)t.children[s[e]].classList.add("player-ship");console.log(a)}}})),t.addEventListener("mouseover",(t=>{if(t.target.classList.contains("grid")){let a=t.target;e=d(a)[0],i=d(a)[1],l.length>0&&n.gamer.checkValidity(e,i,o,r.value)?a.classList.add("green"):l.length>0&&a.classList.add("red")}})),t.addEventListener("mouseout",(e=>{if(e.target.classList.contains("grid")){(t=e.target).classList.remove("green"),t.classList.remove("red")}var t}))}(),r.addEventListener("click",(()=>{"Horizontal"==r.value?(r.value="Vertical",r.textContent="Set Horizontal"):(r.value="Horizontal",r.textContent="Set Vertical")})),function(){let e=c[0];window.addEventListener("click",(()=>{for(;c.length>0;)n.computer.randomPlacement(e),c.shift(),e=c[0];let t=n.computer.getShipsPositions();for(let e=0;e<t.length;e++)i.children[t[e]].classList.add("computer-ship")}))}(),i.addEventListener("click",(e=>{if(0==l.length&&e.target.classList.contains("computer-board")){let t=e.target,i=parseInt(t.classList[0]),r=d(t)[0],o=d(t)[1];n.computer.getShotCoordinates().includes(i)||""!=n.getWinner()||0!=l.length||(n.setInput([r,o]),n.gameLoop())}})),window.addEventListener("click",(()=>{let e=n.gamer.getMissedPositions(),r=n.computer.getMissedPositions(),o=n.gamer.getAttackedPositions(),a=n.computer.getAttackedPositions();for(let n=0;n<e.length;n++)t.children[e[n]].classList.add("missed");for(let e=0;e<r.length;e++)i.children[r[e]].classList.add("missed");for(let e=0;e<o.length;e++)if(t.children[o[e]].classList.add("attacked"),0==t.children[o[e]].children.length){let n=document.createElement("div");n.classList.add("ship-svg"),t.children[o[e]].appendChild(n),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>ship-wheel</title><path d="M2,11L4.05,11.1C4.3,8.83 5.5,6.85 7.25,5.56L6.13,3.84C5.86,3.36 6,2.75 6.5,2.47C7,2.2 7.59,2.36 7.87,2.84L8.8,4.66C9.78,4.24 10.86,4 12,4C13.14,4 14.22,4.24 15.2,4.66L16.13,2.84C16.41,2.36 17,2.2 17.5,2.47C18,2.75 18.14,3.36 17.87,3.84L16.75,5.56C18.5,6.85 19.7,8.83 19.95,11.1L22,11A1,1 0 0,1 23,12A1,1 0 0,1 22,13L19.95,12.9C19.7,15.17 18.5,17.15 16.75,18.44L17.87,20.16C18.14,20.64 18,21.25 17.5,21.53C17,21.8 16.41,21.64 16.13,21.16L15.2,19.34C14.22,19.76 13.14,20 12,20C10.86,20 9.78,19.76 8.8,19.34L7.87,21.16C7.59,21.64 7,21.8 6.5,21.53C6,21.25 5.86,20.64 6.13,20.16L7.25,18.44C5.5,17.15 4.3,15.17 4.05,12.9L2,13A1,1 0 0,1 1,12A1,1 0 0,1 2,11M9.07,11.35C9.2,10.74 9.53,10.2 10,9.79L8.34,7.25C7.11,8.19 6.27,9.6 6.05,11.2L9.07,11.35M12,9C12.32,9 12.62,9.05 12.9,9.14L14.28,6.45C13.58,6.16 12.81,6 12,6C11.19,6 10.42,6.16 9.72,6.45L11.1,9.14C11.38,9.05 11.68,9 12,9M14.93,11.35L17.95,11.2C17.73,9.6 16.89,8.19 15.66,7.25L14,9.79C14.47,10.2 14.8,10.74 14.93,11.35M14.93,12.65C14.8,13.26 14.47,13.8 14,14.21L15.66,16.75C16.89,15.81 17.73,14.4 17.95,12.8L14.93,12.65M12,15C11.68,15 11.38,14.95 11.09,14.86L9.72,17.55C10.42,17.84 11.19,18 12,18C12.81,18 13.58,17.84 14.28,17.55L12.91,14.86C12.62,14.95 12.32,15 12,15M9.07,12.65L6.05,12.8C6.27,14.4 7.11,15.81 8.34,16.75L10,14.21C9.53,13.8 9.2,13.26 9.07,12.65Z" /></svg>'}for(let e=0;e<a.length;e++)if(i.children[a[e]].classList.add("attacked"),0==i.children[a[e]].children.length){let t=document.createElement("div");t.classList.add("ship-svg"),i.children[a[e]].appendChild(t),t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>ship-wheel</title><path d="M2,11L4.05,11.1C4.3,8.83 5.5,6.85 7.25,5.56L6.13,3.84C5.86,3.36 6,2.75 6.5,2.47C7,2.2 7.59,2.36 7.87,2.84L8.8,4.66C9.78,4.24 10.86,4 12,4C13.14,4 14.22,4.24 15.2,4.66L16.13,2.84C16.41,2.36 17,2.2 17.5,2.47C18,2.75 18.14,3.36 17.87,3.84L16.75,5.56C18.5,6.85 19.7,8.83 19.95,11.1L22,11A1,1 0 0,1 23,12A1,1 0 0,1 22,13L19.95,12.9C19.7,15.17 18.5,17.15 16.75,18.44L17.87,20.16C18.14,20.64 18,21.25 17.5,21.53C17,21.8 16.41,21.64 16.13,21.16L15.2,19.34C14.22,19.76 13.14,20 12,20C10.86,20 9.78,19.76 8.8,19.34L7.87,21.16C7.59,21.64 7,21.8 6.5,21.53C6,21.25 5.86,20.64 6.13,20.16L7.25,18.44C5.5,17.15 4.3,15.17 4.05,12.9L2,13A1,1 0 0,1 1,12A1,1 0 0,1 2,11M9.07,11.35C9.2,10.74 9.53,10.2 10,9.79L8.34,7.25C7.11,8.19 6.27,9.6 6.05,11.2L9.07,11.35M12,9C12.32,9 12.62,9.05 12.9,9.14L14.28,6.45C13.58,6.16 12.81,6 12,6C11.19,6 10.42,6.16 9.72,6.45L11.1,9.14C11.38,9.05 11.68,9 12,9M14.93,11.35L17.95,11.2C17.73,9.6 16.89,8.19 15.66,7.25L14,9.79C14.47,10.2 14.8,10.74 14.93,11.35M14.93,12.65C14.8,13.26 14.47,13.8 14,14.21L15.66,16.75C16.89,15.81 17.73,14.4 17.95,12.8L14.93,12.65M12,15C11.68,15 11.38,14.95 11.09,14.86L9.72,17.55C10.42,17.84 11.19,18 12,18C12.81,18 13.58,17.84 14.28,17.55L12.91,14.86C12.62,14.95 12.32,15 12,15M9.07,12.65L6.05,12.8C6.27,14.4 7.11,15.81 8.34,16.75L10,14.21C9.53,13.8 9.2,13.26 9.07,12.65Z" /></svg>'}})),o.addEventListener("click",(()=>{location.reload()})),{createGameBoards:function(){for(let e=0;e<a.length;e++){let n=document.createElement("div");n.classList.add(e),n.classList.add(a[e].coordinates),n.classList.add("grid"),n.classList.add("player-board"),t.appendChild(n)}for(let e=0;e<s.length;e++){let t=document.createElement("div");t.classList.add(e),t.classList.add(s[e].coordinates),t.classList.add("grid"),t.classList.add("computer-board"),i.appendChild(t)}}}})().createGameBoards()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxJQUFJNUQsRUFBSSxFQUFHQSxFQUFJNEIsRUFBY2hELE9BQVFvQixJQUFLLENBQzdDLElBQUk0RCxFQUFPZixTQUFTNkIsY0FBYyxPQUNsQ2QsRUFBS1AsVUFBVWEsSUFBSWxFLEdBQ25CNEQsRUFBS1AsVUFBVWEsSUFBSXRDLEVBQWM1QixHQUFHSyxhQUNwQ3VELEVBQUtQLFVBQVVhLElBQUksUUFDbkJOLEVBQUtQLFVBQVVhLElBQUksa0JBQ25CbEIsRUFBaUIyQixZQUFZZixFQUMvQixDQUNGLEVBc05ELEVBblBXLEdDQ1JtQixrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9kb20uanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzaGlwID0gZnVuY3Rpb24gKGxlbmd0aCwgbmFtZSkge1xuICBsZXQgaGl0cyA9IDA7XG4gIGxldCBzdW5rID0gZmFsc2U7XG4gIGxldCBzaGlwTmFtZSA9IG5hbWU7XG5cbiAgZnVuY3Rpb24gaGl0KCkge1xuICAgIGhpdHMgKz0gMTtcbiAgICByZXR1cm4gaGl0cztcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzU3VuaygpIHtcbiAgICBpZiAoaGl0cyA9PSBsZW5ndGgpIHtcbiAgICAgIHN1bmsgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gc3VuaztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEhpdHMoKSB7XG4gICAgcmV0dXJuIGhpdHM7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGhpdCxcbiAgICBnZXRIaXRzLFxuICAgIGlzU3VuayxcbiAgICBsZW5ndGgsXG4gICAgc2hpcE5hbWUsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzaGlwO1xuIiwiaW1wb3J0IHNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcblxuY29uc3QgcGxheWVyID0gZnVuY3Rpb24gKCkge1xuICBsZXQgYm9hcmQgPSBnYW1lQm9hcmQoKTtcbiAgbGV0IGNhcnJpZXIgPSBzaGlwKDUsIFwiQ2FycmllclwiKTtcbiAgbGV0IGJhdHRsZXNoaXAgPSBzaGlwKDQsIFwiQmF0dGxlc2hpcFwiKTtcbiAgbGV0IGNydWlzZXIgPSBzaGlwKDMsIFwiQ3J1aXNlclwiKTtcbiAgbGV0IHN1Ym1hcmluZSA9IHNoaXAoMywgXCJTdWJtYXJpbmVcIik7XG4gIGxldCBkZXN0cm95ZXIgPSBzaGlwKDIsIFwiRGVzdHJveWVyXCIpO1xuICBsZXQgc2hpcHMgPSBbY2FycmllciwgYmF0dGxlc2hpcCwgY3J1aXNlciwgc3VibWFyaW5lLCBkZXN0cm95ZXJdO1xuXG4gIGZ1bmN0aW9uIGluZGV4RmluZGVyKHBvczEsIHBvczIpIHtcbiAgICBsZXQgaW5kZXggPSBwb3MxICogMTAgKyBwb3MyO1xuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJhbmRvbUNvb3JkaW5hdGVzKCkge1xuICAgIGxldCB4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIGxldCB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuXG4gICAgcmV0dXJuIFt4LCB5XTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJhbmRvbUF0dGFjayhwbGF5ZXIpIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSByYW5kb21Db29yZGluYXRlcygpO1xuICAgIGxldCBwb3MxID0gY29vcmRpbmF0ZXNbMF07XG4gICAgbGV0IHBvczIgPSBjb29yZGluYXRlc1sxXTtcblxuICAgIGxldCBpbmRleCA9IGluZGV4RmluZGVyKHBvczEsIHBvczIpO1xuXG4gICAgaWYgKHBsYXllci5nZXRTaG90Q29vcmRpbmF0ZXMoKS5pbmNsdWRlcyhpbmRleCkpIHtcbiAgICAgIHJhbmRvbUF0dGFjayhwbGF5ZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwbGF5ZXIucmVjZWl2ZUF0dGFjayhwb3MxLCBwb3MyKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByYW5kb21QbGFjZW1lbnQoc2hpcCkge1xuICAgIGxldCBjb29yZGluYXRlcyA9IHJhbmRvbUNvb3JkaW5hdGVzKCk7XG4gICAgbGV0IHBvczEgPSBjb29yZGluYXRlc1swXTtcbiAgICBsZXQgcG9zMiA9IGNvb3JkaW5hdGVzWzFdO1xuICAgIGxldCBkaXJlY3Rpb24gPSBcIlwiO1xuXG4gICAgbGV0IHJhbmRvbURpcmVjdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpO1xuXG4gICAgaWYgKHJhbmRvbURpcmVjdGlvbiA9PSAxKSB7XG4gICAgICBkaXJlY3Rpb24gPSBcIkhvcml6b250YWxcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgZGlyZWN0aW9uID0gXCJWZXJ0aWNhbFwiO1xuICAgIH1cblxuICAgIGlmIChib2FyZC5jaGVja1ZhbGlkaXR5KHBvczEsIHBvczIsIHNoaXAsIGRpcmVjdGlvbikpIHtcbiAgICAgIGJvYXJkLnBsYWNlU2hpcChwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pO1xuICAgIH0gZWxzZSB7XG4gICAgICByYW5kb21QbGFjZW1lbnQoc2hpcCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Qm9hcmQoKSB7XG4gICAgcmV0dXJuIGJvYXJkO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U2hpcHMoKSB7XG4gICAgcmV0dXJuIHNoaXBzO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U2hvdENvb3JkaW5hdGVzKCkge1xuICAgIGxldCBhdHRhY2tlZCA9IGJvYXJkLmdldEF0dGFja2VkUG9zaXRpb25zKCk7XG4gICAgbGV0IG1pc3NlZCA9IGJvYXJkLmdldE1pc3NlZFBvc2l0aW9ucygpO1xuICAgIGxldCBzaG90Q29vcmRpbmF0ZXMgPSBbLi4uYXR0YWNrZWQsIC4uLm1pc3NlZF07XG4gICAgcmV0dXJuIHNob3RDb29yZGluYXRlcztcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcmFuZG9tQXR0YWNrLFxuICAgIHJhbmRvbVBsYWNlbWVudCxcbiAgICBnZXRCb2FyZCxcbiAgICBnZXRTaGlwcyxcbiAgICBnZXRTaG90Q29vcmRpbmF0ZXMsXG4gICAgY3JlYXRlQm9hcmQ6IGJvYXJkLmNyZWF0ZUJvYXJkLFxuICAgIGdldEJvYXJkOiBib2FyZC5nZXRCb2FyZCxcbiAgICBwbGFjZVNoaXA6IGJvYXJkLnBsYWNlU2hpcCxcbiAgICBjaGVja1ZhbGlkaXR5OiBib2FyZC5jaGVja1ZhbGlkaXR5LFxuICAgIHJlY2VpdmVBdHRhY2s6IGJvYXJkLnJlY2VpdmVBdHRhY2ssXG4gICAgaXNBbGxTdW5rOiBib2FyZC5pc0FsbFN1bmssXG4gICAgZ2V0TWlzc2VkUG9zaXRpb25zOiBib2FyZC5nZXRNaXNzZWRQb3NpdGlvbnMsXG4gICAgZ2V0QXR0YWNrZWRQb3NpdGlvbnM6IGJvYXJkLmdldEF0dGFja2VkUG9zaXRpb25zLFxuICAgIGdldFNoaXBzUG9zaXRpb25zOiBib2FyZC5nZXRTaGlwc1Bvc2l0aW9ucyxcbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHBsYXllcjtcbiIsImltcG9ydCBzaGlwIGZyb20gXCIuL3NoaXBcIjtcbmNvbnN0IGdhbWVCb2FyZCA9IGZ1bmN0aW9uICgpIHtcbiAgbGV0IGJvYXJkID0gW107XG4gIGxldCBtaXNzZWRBdHRhY2sgPSBbXTtcbiAgbGV0IGF0dGFja2VkUG9zaXRpb24gPSBbXTtcbiAgbGV0IHNoaXBQb3NpdGlvbiA9IFtdO1xuICBsZXQgc2hpcHMgPSBbXTtcblxuICBmdW5jdGlvbiBjcmVhdGVDb29yZGluYXRlKGNvb3JkaW5hdGVzLCBuYW1lKSB7XG4gICAgcmV0dXJuIHsgY29vcmRpbmF0ZXMsIG5hbWUgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGluZGV4RmluZGVyKHBvczEsIHBvczIpIHtcbiAgICBsZXQgaW5kZXggPSBwb3MxICogMTAgKyBwb3MyO1xuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZUJvYXJkKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIGxldCBuZXdDb29yZGluYXRlcyA9IGNyZWF0ZUNvb3JkaW5hdGUoKTtcbiAgICAgICAgbmV3Q29vcmRpbmF0ZXMuY29vcmRpbmF0ZXMgPSBbaSwgal07XG4gICAgICAgIG5ld0Nvb3JkaW5hdGVzLm5hbWUgPSBudWxsO1xuICAgICAgICBib2FyZC5wdXNoKG5ld0Nvb3JkaW5hdGVzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJvYXJkO1xuICB9XG5cbiAgZnVuY3Rpb24gY2hlY2tWYWxpZGl0eShwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pIHtcbiAgICBsZXQgaW5kZXggPSBpbmRleEZpbmRlcihwb3MxLCBwb3MyKTtcblxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJIb3Jpem9udGFsXCIpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoc2hpcFBvc2l0aW9uLmluY2x1ZGVzKGluZGV4ICsgaSkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZGlyZWN0aW9uID09IFwiVmVydGljYWxcIikge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChzaGlwUG9zaXRpb24uaW5jbHVkZXMoaW5kZXggKyBpICogMTApKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcIkhvcml6b250YWxcIiAmJiBwb3MyICsgc2hpcC5sZW5ndGggPiAxMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJWZXJ0aWNhbFwiICYmIHBvczEgKyBzaGlwLmxlbmd0aCA+IDEwKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxhY2VTaGlwKHBvczEsIHBvczIsIHNoaXAsIGRpcmVjdGlvbikge1xuICAgIGlmIChcbiAgICAgIGRpcmVjdGlvbiA9PSBcIkhvcml6b250YWxcIiAmJlxuICAgICAgY2hlY2tWYWxpZGl0eShwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pXG4gICAgKSB7XG4gICAgICBsZXQgaW5kZXggPSBpbmRleEZpbmRlcihwb3MxLCBwb3MyKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJvYXJkW2luZGV4ICsgaV0ubmFtZSA9IHNoaXAuc2hpcE5hbWU7XG4gICAgICAgIHNoaXBQb3NpdGlvbi5wdXNoKGluZGV4ICsgaSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcIlZlcnRpY2FsXCIgJiYgY2hlY2tWYWxpZGl0eShwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pKSB7XG4gICAgICBsZXQgaW5kZXggPSBpbmRleEZpbmRlcihwb3MxLCBwb3MyKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGJvYXJkW2luZGV4ICsgaSAqIDEwXS5uYW1lID0gc2hpcC5zaGlwTmFtZTtcbiAgICAgICAgc2hpcFBvc2l0aW9uLnB1c2goaW5kZXggKyBpICogMTApO1xuICAgICAgfVxuICAgIH1cbiAgICBzaGlwcy5wdXNoKHNoaXApO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVjZWl2ZUF0dGFjayhwb3MxLCBwb3MyKSB7XG4gICAgbGV0IGluZGV4ID0gaW5kZXhGaW5kZXIocG9zMSwgcG9zMik7XG5cbiAgICBpZiAoYm9hcmRbaW5kZXhdLm5hbWUgIT0gbnVsbCkge1xuICAgICAgaWYgKCFhdHRhY2tlZFBvc2l0aW9uLmluY2x1ZGVzKGluZGV4KSkge1xuICAgICAgICBhdHRhY2tlZFBvc2l0aW9uLnB1c2goaW5kZXgpO1xuICAgICAgICBmaW5kU2hpcChib2FyZFtpbmRleF0ubmFtZSkuaGl0KCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghbWlzc2VkQXR0YWNrLmluY2x1ZGVzKGluZGV4KSkge1xuICAgICAgICBtaXNzZWRBdHRhY2sucHVzaChpbmRleCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZmluZFNoaXAobmFtZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChzaGlwc1tpXS5zaGlwTmFtZSA9PSBuYW1lKSB7XG4gICAgICAgIHJldHVybiBzaGlwc1tpXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBpc0FsbFN1bmsoKSB7XG4gICAgaWYgKHNoaXBQb3NpdGlvbi5sZW5ndGggPT0gYXR0YWNrZWRQb3NpdGlvbi5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEJvYXJkKCkge1xuICAgIHJldHVybiBib2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldE1pc3NlZFBvc2l0aW9ucygpIHtcbiAgICByZXR1cm4gbWlzc2VkQXR0YWNrO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0U2hpcHNQb3NpdGlvbnMoKSB7XG4gICAgcmV0dXJuIHNoaXBQb3NpdGlvbjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEF0dGFja2VkUG9zaXRpb25zKCkge1xuICAgIHJldHVybiBhdHRhY2tlZFBvc2l0aW9uO1xuICB9XG4gIHJldHVybiB7XG4gICAgY3JlYXRlQm9hcmQsXG4gICAgZ2V0Qm9hcmQsXG4gICAgY2hlY2tWYWxpZGl0eSxcbiAgICBwbGFjZVNoaXAsXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBpc0FsbFN1bmssXG4gICAgZ2V0TWlzc2VkUG9zaXRpb25zLFxuICAgIGdldEF0dGFja2VkUG9zaXRpb25zLFxuICAgIGdldFNoaXBzUG9zaXRpb25zLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZ2FtZUJvYXJkO1xuIiwiaW1wb3J0IHNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBwbGF5ZXIgZnJvbSBcIi4vcGxheWVyXCI7XG5cbmNvbnN0IGdhbWUgPSAoZnVuY3Rpb24gKCkge1xuICBsZXQgZ2FtZXIgPSBwbGF5ZXIoKTtcbiAgbGV0IGNvbXB1dGVyID0gcGxheWVyKCk7XG5cbiAgZ2FtZXIuY3JlYXRlQm9hcmQoKTtcbiAgY29tcHV0ZXIuY3JlYXRlQm9hcmQoKTtcblxuICBsZXQgZ2FtZXJCb2FyZCA9IGdhbWVyLmdldEJvYXJkKCk7XG4gIGxldCBjb21wdXRlckJvYXJkID0gY29tcHV0ZXIuZ2V0Qm9hcmQoKTtcbiAgbGV0IGdhbWVyU2hpcHMgPSBnYW1lci5nZXRTaGlwcygpO1xuICBsZXQgY29tcHV0ZXJTaGlwcyA9IGNvbXB1dGVyLmdldFNoaXBzKCk7XG5cbiAgbGV0IHR1cm4gPSBcIkdhbWVyXCI7XG4gIGxldCB3aW5uZXIgPSBcIlwiO1xuICBsZXQgaW5wdXQgPSBbXTtcblxuICBmdW5jdGlvbiBnYW1lTG9vcCgpIHtcbiAgICBpZiAodHVybiA9PSBcIkdhbWVyXCIpIHtcbiAgICAgIGNvbXB1dGVyLnJlY2VpdmVBdHRhY2soaW5wdXRbMF0sIGlucHV0WzFdKTtcbiAgICAgIGlmIChjb21wdXRlci5pc0FsbFN1bmsoKSkge1xuICAgICAgICB3aW5uZXIgPSBcIkdhbWVyXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0dXJuID0gXCJDb21wdXRlclwiO1xuICAgICAgICBpbnB1dCA9IFtdO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodHVybiA9PSBcIkNvbXB1dGVyXCIpIHtcbiAgICAgIGNvbXB1dGVyLnJhbmRvbUF0dGFjayhnYW1lcik7XG4gICAgICBpZiAoZ2FtZXIuaXNBbGxTdW5rKCkpIHtcbiAgICAgICAgd2lubmVyID0gXCJDb21wdXRlclwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHVybiA9IFwiR2FtZXJcIjtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc29sZS5sb2cod2lubmVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldElucHV0KGNvb3JkaW5hdGVzKSB7XG4gICAgaW5wdXQgPSBjb29yZGluYXRlcztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFR1cm4oKSB7XG4gICAgcmV0dXJuIHR1cm47XG4gIH1cblxuICBmdW5jdGlvbiBnZXRXaW5uZXIoKSB7XG4gICAgcmV0dXJuIHdpbm5lcjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEdhbWVyQm9hcmQoKSB7XG4gICAgcmV0dXJuIGdhbWVyQm9hcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRDb21wdXRlckJvYXJkKCkge1xuICAgIHJldHVybiBjb21wdXRlckJvYXJkO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0R2FtZXJTaGlwcygpIHtcbiAgICByZXR1cm4gZ2FtZXJTaGlwcztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldENvbXB1dGVyU2hpcHMoKSB7XG4gICAgcmV0dXJuIGNvbXB1dGVyU2hpcHM7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdhbWVyLFxuICAgIGNvbXB1dGVyLFxuICAgIHNldElucHV0LFxuICAgIGdhbWVMb29wLFxuICAgIGdldFR1cm4sXG4gICAgZ2V0V2lubmVyLFxuICAgIGdldEdhbWVyQm9hcmQsXG4gICAgZ2V0Q29tcHV0ZXJCb2FyZCxcbiAgICBnZXRHYW1lclNoaXBzLFxuICAgIGdldENvbXB1dGVyU2hpcHMsXG4gIH07XG59KSgpO1xuXG5leHBvcnQgZGVmYXVsdCBnYW1lO1xuIiwiaW1wb3J0IHNoaXAgZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCBwbGF5ZXIgZnJvbSBcIi4vcGxheWVyXCI7XG5pbXBvcnQgZ2FtZSBmcm9tIFwiLi9nYW1lXCI7XG5cbmNvbnN0IGRvbSA9IChmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGRpc3BsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpc3BsYXlcIik7XG4gIGNvbnN0IHBsYXllckJvYXJkRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItYm9hcmRcIik7XG4gIGNvbnN0IGNvbXB1dGVyQm9hcmREaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXB1dGVyLWJvYXJkXCIpO1xuICBjb25zdCBkaXJlY3Rpb25CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpcmVjdGlvblwiKTtcbiAgY29uc3QgcmVzZXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJlc2V0XCIpO1xuXG4gIGxldCBnYW1lckJvYXJkID0gZ2FtZS5nZXRHYW1lckJvYXJkKCk7XG4gIGxldCBjb21wdXRlckJvYXJkID0gZ2FtZS5nZXRDb21wdXRlckJvYXJkKCk7XG4gIGxldCBnYW1lclNoaXBzID0gWy4uLmdhbWUuZ2V0R2FtZXJTaGlwcygpXTtcbiAgbGV0IGNvbXB1dGVyU2hpcHMgPSBbLi4uZ2FtZS5nZXRDb21wdXRlclNoaXBzKCldO1xuXG4gIGZ1bmN0aW9uIGNyZWF0ZUdhbWVCb2FyZHMoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnYW1lckJvYXJkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgZ3JpZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoaSk7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoZ2FtZXJCb2FyZFtpXS5jb29yZGluYXRlcyk7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoXCJncmlkXCIpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKFwicGxheWVyLWJvYXJkXCIpO1xuICAgICAgcGxheWVyQm9hcmREaXYuYXBwZW5kQ2hpbGQoZ3JpZCk7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29tcHV0ZXJCb2FyZC5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGdyaWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKGkpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKGNvbXB1dGVyQm9hcmRbaV0uY29vcmRpbmF0ZXMpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKFwiZ3JpZFwiKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChcImNvbXB1dGVyLWJvYXJkXCIpO1xuICAgICAgY29tcHV0ZXJCb2FyZERpdi5hcHBlbmRDaGlsZChncmlkKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRDb29yZGluYXRlcyh0YXJnZXQpIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSB0YXJnZXQuY2xhc3NMaXN0WzFdLnNwbGl0KFwiLFwiKTtcbiAgICBsZXQgcG9zMSA9IHBhcnNlSW50KGNvb3JkaW5hdGVzWzBdKTtcbiAgICBsZXQgcG9zMiA9IHBhcnNlSW50KGNvb3JkaW5hdGVzWzFdKTtcblxuICAgIHJldHVybiBbcG9zMSwgcG9zMl07XG4gIH1cblxuICBmdW5jdGlvbiBhZGRWYWxpZGl0eUNvbG9yKGNlbGwpIHtcbiAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJncmVlblwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbW92ZVZhbGlkaXR5Q29sb3IoY2VsbCkge1xuICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZShcImdyZWVuXCIpO1xuICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZShcInJlZFwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZE5vblZhbGlkaXR5Q29sb3IoY2VsbCkge1xuICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcInJlZFwiKTtcbiAgfVxuXG4gIChmdW5jdGlvbiBkaXNwbGF5RXZlbnRzKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiB7XG4gICAgICBkaXNwbGF5LnRleHRDb250ZW50ID0gXCJXZWxjb21lIHRvIEJhdHRsZXNoaXAuIFBsYWNlIHlvdXIgQ2FycmllclwiO1xuICAgIH0pO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBzd2l0Y2ggKGdhbWVyU2hpcHMubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICBkaXNwbGF5LnRleHRDb250ZW50ID0gXCJQbGFjZSB5b3VyIEJhdHRsZXNoaXBcIjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgQ3J1aXNlclwiO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IFwiUGxhY2UgeW91ciBTdWJtYXJpbmVcIjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgRGVzdHJveWVyXCI7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgIGlmIChnYW1lLmdldFdpbm5lcigpID09IFwiXCIpIHtcbiAgICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBgJHtnYW1lLmdldFR1cm4oKX0ncyBUdXJuYDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IGAke2dhbWUuZ2V0V2lubmVyKCl9IFdvbmA7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KSgpO1xuXG4gIChmdW5jdGlvbiBwbGF5ZXJCb2FyZEV2ZW50cygpIHtcbiAgICBsZXQgY3VycmVudFNoaXAgPSBnYW1lclNoaXBzWzBdO1xuICAgIGxldCBwb3MxO1xuICAgIGxldCBwb3MyO1xuXG4gICAgcGxheWVyQm9hcmREaXYuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChncmlkKSA9PiB7XG4gICAgICBpZiAoZ3JpZC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicGxheWVyLWJvYXJkXCIpKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgcG9zMSA9IGdldENvb3JkaW5hdGVzKHRhcmdldClbMF07XG4gICAgICAgIHBvczIgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzFdO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgZ2FtZXJTaGlwcy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgZ2FtZS5nYW1lci5jaGVja1ZhbGlkaXR5KFxuICAgICAgICAgICAgcG9zMSxcbiAgICAgICAgICAgIHBvczIsXG4gICAgICAgICAgICBjdXJyZW50U2hpcCxcbiAgICAgICAgICAgIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZVxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgZ2FtZS5nYW1lci5wbGFjZVNoaXAocG9zMSwgcG9zMiwgY3VycmVudFNoaXAsIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZSk7XG4gICAgICAgICAgZ2FtZXJTaGlwcy5zaGlmdCgpO1xuICAgICAgICAgIGN1cnJlbnRTaGlwID0gZ2FtZXJTaGlwc1swXTtcbiAgICAgICAgICBsZXQgc2hpcFBvc2l0aW9ucyA9IGdhbWUuZ2FtZXIuZ2V0U2hpcHNQb3NpdGlvbnMoKTtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW3NoaXBQb3NpdGlvbnNbaV1dLmNsYXNzTGlzdC5hZGQoXG4gICAgICAgICAgICAgIFwicGxheWVyLXNoaXBcIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc29sZS5sb2coZ2FtZXJCb2FyZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHBsYXllckJvYXJkRGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgKGdyaWQpID0+IHtcbiAgICAgIGlmIChncmlkLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJncmlkXCIpKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgcG9zMSA9IGdldENvb3JkaW5hdGVzKHRhcmdldClbMF07XG4gICAgICAgIHBvczIgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzFdO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgZ2FtZXJTaGlwcy5sZW5ndGggPiAwICYmXG4gICAgICAgICAgZ2FtZS5nYW1lci5jaGVja1ZhbGlkaXR5KFxuICAgICAgICAgICAgcG9zMSxcbiAgICAgICAgICAgIHBvczIsXG4gICAgICAgICAgICBjdXJyZW50U2hpcCxcbiAgICAgICAgICAgIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZVxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgYWRkVmFsaWRpdHlDb2xvcih0YXJnZXQpO1xuICAgICAgICB9IGVsc2UgaWYgKGdhbWVyU2hpcHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGFkZE5vblZhbGlkaXR5Q29sb3IodGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcGxheWVyQm9hcmREaXYuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsIChncmlkKSA9PiB7XG4gICAgICBpZiAoZ3JpZC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZ3JpZFwiKSkge1xuICAgICAgICBsZXQgdGFyZ2V0ID0gZ3JpZC50YXJnZXQ7XG4gICAgICAgIHJlbW92ZVZhbGlkaXR5Q29sb3IodGFyZ2V0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSkoKTtcblxuICBkaXJlY3Rpb25CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBpZiAoZGlyZWN0aW9uQnV0dG9uLnZhbHVlID09IFwiSG9yaXpvbnRhbFwiKSB7XG4gICAgICBkaXJlY3Rpb25CdXR0b24udmFsdWUgPSBcIlZlcnRpY2FsXCI7XG4gICAgICBkaXJlY3Rpb25CdXR0b24udGV4dENvbnRlbnQgPSBcIlNldCBIb3Jpem9udGFsXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpcmVjdGlvbkJ1dHRvbi52YWx1ZSA9IFwiSG9yaXpvbnRhbFwiO1xuICAgICAgZGlyZWN0aW9uQnV0dG9uLnRleHRDb250ZW50ID0gXCJTZXQgVmVydGljYWxcIjtcbiAgICB9XG4gIH0pO1xuXG4gIChmdW5jdGlvbiBjb21wdXRlckJvYXJkRXZlbnRzKCkge1xuICAgIGxldCBjdXJyZW50U2hpcCA9IGNvbXB1dGVyU2hpcHNbMF07XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB3aGlsZSAoY29tcHV0ZXJTaGlwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGdhbWUuY29tcHV0ZXIucmFuZG9tUGxhY2VtZW50KGN1cnJlbnRTaGlwKTtcbiAgICAgICAgY29tcHV0ZXJTaGlwcy5zaGlmdCgpO1xuICAgICAgICBjdXJyZW50U2hpcCA9IGNvbXB1dGVyU2hpcHNbMF07XG4gICAgICB9XG4gICAgICBsZXQgc2hpcFBvc2l0aW9ucyA9IGdhbWUuY29tcHV0ZXIuZ2V0U2hpcHNQb3NpdGlvbnMoKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcFBvc2l0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW3NoaXBQb3NpdGlvbnNbaV1dLmNsYXNzTGlzdC5hZGQoXG4gICAgICAgICAgXCJjb21wdXRlci1zaGlwXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSkoKTtcblxuICAoZnVuY3Rpb24gZ2FtZUxvb3BFdmVudHMoKSB7XG4gICAgY29tcHV0ZXJCb2FyZERpdi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGdyaWQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZ2FtZXJTaGlwcy5sZW5ndGggPT0gMCAmJlxuICAgICAgICBncmlkLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjb21wdXRlci1ib2FyZFwiKVxuICAgICAgKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgbGV0IGluZGV4ID0gcGFyc2VJbnQodGFyZ2V0LmNsYXNzTGlzdFswXSk7XG4gICAgICAgIGxldCBwb3MxID0gZ2V0Q29vcmRpbmF0ZXModGFyZ2V0KVswXTtcbiAgICAgICAgbGV0IHBvczIgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzFdO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAhZ2FtZS5jb21wdXRlci5nZXRTaG90Q29vcmRpbmF0ZXMoKS5pbmNsdWRlcyhpbmRleCkgJiZcbiAgICAgICAgICBnYW1lLmdldFdpbm5lcigpID09IFwiXCIgJiZcbiAgICAgICAgICBnYW1lclNoaXBzLmxlbmd0aCA9PSAwXG4gICAgICAgICkge1xuICAgICAgICAgIGdhbWUuc2V0SW5wdXQoW3BvczEsIHBvczJdKTtcbiAgICAgICAgICBnYW1lLmdhbWVMb29wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgbGV0IGdhbWVyTWlzc2VkUG9zID0gZ2FtZS5nYW1lci5nZXRNaXNzZWRQb3NpdGlvbnMoKTtcbiAgICAgIGxldCBjb21wdXRlck1pc3NlZFBvcyA9IGdhbWUuY29tcHV0ZXIuZ2V0TWlzc2VkUG9zaXRpb25zKCk7XG4gICAgICBsZXQgZ2FtZXJBdHRhY2tlZFBvcyA9IGdhbWUuZ2FtZXIuZ2V0QXR0YWNrZWRQb3NpdGlvbnMoKTtcbiAgICAgIGxldCBjb21wdXRlckF0dGFja2VkUG9zID0gZ2FtZS5jb21wdXRlci5nZXRBdHRhY2tlZFBvc2l0aW9ucygpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdhbWVyTWlzc2VkUG9zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW2dhbWVyTWlzc2VkUG9zW2ldXS5jbGFzc0xpc3QuYWRkKFwibWlzc2VkXCIpO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb21wdXRlck1pc3NlZFBvcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW2NvbXB1dGVyTWlzc2VkUG9zW2ldXS5jbGFzc0xpc3QuYWRkKFwibWlzc2VkXCIpO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnYW1lckF0dGFja2VkUG9zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW2dhbWVyQXR0YWNrZWRQb3NbaV1dLmNsYXNzTGlzdC5hZGQoXCJhdHRhY2tlZFwiKTtcblxuICAgICAgICBpZiAocGxheWVyQm9hcmREaXYuY2hpbGRyZW5bZ2FtZXJBdHRhY2tlZFBvc1tpXV0uY2hpbGRyZW4ubGVuZ3RoID09IDApIHtcbiAgICAgICAgICBsZXQgc3ZnRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICBzdmdEaXYuY2xhc3NMaXN0LmFkZChcInNoaXAtc3ZnXCIpO1xuICAgICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW2dhbWVyQXR0YWNrZWRQb3NbaV1dLmFwcGVuZENoaWxkKHN2Z0Rpdik7XG4gICAgICAgICAgc3ZnRGl2LmlubmVySFRNTCA9XG4gICAgICAgICAgICAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPjx0aXRsZT5zaGlwLXdoZWVsPC90aXRsZT48cGF0aCBkPVwiTTIsMTFMNC4wNSwxMS4xQzQuMyw4LjgzIDUuNSw2Ljg1IDcuMjUsNS41Nkw2LjEzLDMuODRDNS44NiwzLjM2IDYsMi43NSA2LjUsMi40N0M3LDIuMiA3LjU5LDIuMzYgNy44NywyLjg0TDguOCw0LjY2QzkuNzgsNC4yNCAxMC44Niw0IDEyLDRDMTMuMTQsNCAxNC4yMiw0LjI0IDE1LjIsNC42NkwxNi4xMywyLjg0QzE2LjQxLDIuMzYgMTcsMi4yIDE3LjUsMi40N0MxOCwyLjc1IDE4LjE0LDMuMzYgMTcuODcsMy44NEwxNi43NSw1LjU2QzE4LjUsNi44NSAxOS43LDguODMgMTkuOTUsMTEuMUwyMiwxMUExLDEgMCAwLDEgMjMsMTJBMSwxIDAgMCwxIDIyLDEzTDE5Ljk1LDEyLjlDMTkuNywxNS4xNyAxOC41LDE3LjE1IDE2Ljc1LDE4LjQ0TDE3Ljg3LDIwLjE2QzE4LjE0LDIwLjY0IDE4LDIxLjI1IDE3LjUsMjEuNTNDMTcsMjEuOCAxNi40MSwyMS42NCAxNi4xMywyMS4xNkwxNS4yLDE5LjM0QzE0LjIyLDE5Ljc2IDEzLjE0LDIwIDEyLDIwQzEwLjg2LDIwIDkuNzgsMTkuNzYgOC44LDE5LjM0TDcuODcsMjEuMTZDNy41OSwyMS42NCA3LDIxLjggNi41LDIxLjUzQzYsMjEuMjUgNS44NiwyMC42NCA2LjEzLDIwLjE2TDcuMjUsMTguNDRDNS41LDE3LjE1IDQuMywxNS4xNyA0LjA1LDEyLjlMMiwxM0ExLDEgMCAwLDEgMSwxMkExLDEgMCAwLDEgMiwxMU05LjA3LDExLjM1QzkuMiwxMC43NCA5LjUzLDEwLjIgMTAsOS43OUw4LjM0LDcuMjVDNy4xMSw4LjE5IDYuMjcsOS42IDYuMDUsMTEuMkw5LjA3LDExLjM1TTEyLDlDMTIuMzIsOSAxMi42Miw5LjA1IDEyLjksOS4xNEwxNC4yOCw2LjQ1QzEzLjU4LDYuMTYgMTIuODEsNiAxMiw2QzExLjE5LDYgMTAuNDIsNi4xNiA5LjcyLDYuNDVMMTEuMSw5LjE0QzExLjM4LDkuMDUgMTEuNjgsOSAxMiw5TTE0LjkzLDExLjM1TDE3Ljk1LDExLjJDMTcuNzMsOS42IDE2Ljg5LDguMTkgMTUuNjYsNy4yNUwxNCw5Ljc5QzE0LjQ3LDEwLjIgMTQuOCwxMC43NCAxNC45MywxMS4zNU0xNC45MywxMi42NUMxNC44LDEzLjI2IDE0LjQ3LDEzLjggMTQsMTQuMjFMMTUuNjYsMTYuNzVDMTYuODksMTUuODEgMTcuNzMsMTQuNCAxNy45NSwxMi44TDE0LjkzLDEyLjY1TTEyLDE1QzExLjY4LDE1IDExLjM4LDE0Ljk1IDExLjA5LDE0Ljg2TDkuNzIsMTcuNTVDMTAuNDIsMTcuODQgMTEuMTksMTggMTIsMThDMTIuODEsMTggMTMuNTgsMTcuODQgMTQuMjgsMTcuNTVMMTIuOTEsMTQuODZDMTIuNjIsMTQuOTUgMTIuMzIsMTUgMTIsMTVNOS4wNywxMi42NUw2LjA1LDEyLjhDNi4yNywxNC40IDcuMTEsMTUuODEgOC4zNCwxNi43NUwxMCwxNC4yMUM5LjUzLDEzLjggOS4yLDEzLjI2IDkuMDcsMTIuNjVaXCIgLz48L3N2Zz4nO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbXB1dGVyQXR0YWNrZWRQb3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29tcHV0ZXJCb2FyZERpdi5jaGlsZHJlbltjb21wdXRlckF0dGFja2VkUG9zW2ldXS5jbGFzc0xpc3QuYWRkKFxuICAgICAgICAgIFwiYXR0YWNrZWRcIlxuICAgICAgICApO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW2NvbXB1dGVyQXR0YWNrZWRQb3NbaV1dLmNoaWxkcmVuLmxlbmd0aCA9PSAwXG4gICAgICAgICkge1xuICAgICAgICAgIGxldCBzdmdEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgIHN2Z0Rpdi5jbGFzc0xpc3QuYWRkKFwic2hpcC1zdmdcIik7XG4gICAgICAgICAgY29tcHV0ZXJCb2FyZERpdi5jaGlsZHJlbltjb21wdXRlckF0dGFja2VkUG9zW2ldXS5hcHBlbmRDaGlsZChzdmdEaXYpO1xuICAgICAgICAgIHN2Z0Rpdi5pbm5lckhUTUwgPVxuICAgICAgICAgICAgJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj48dGl0bGU+c2hpcC13aGVlbDwvdGl0bGU+PHBhdGggZD1cIk0yLDExTDQuMDUsMTEuMUM0LjMsOC44MyA1LjUsNi44NSA3LjI1LDUuNTZMNi4xMywzLjg0QzUuODYsMy4zNiA2LDIuNzUgNi41LDIuNDdDNywyLjIgNy41OSwyLjM2IDcuODcsMi44NEw4LjgsNC42NkM5Ljc4LDQuMjQgMTAuODYsNCAxMiw0QzEzLjE0LDQgMTQuMjIsNC4yNCAxNS4yLDQuNjZMMTYuMTMsMi44NEMxNi40MSwyLjM2IDE3LDIuMiAxNy41LDIuNDdDMTgsMi43NSAxOC4xNCwzLjM2IDE3Ljg3LDMuODRMMTYuNzUsNS41NkMxOC41LDYuODUgMTkuNyw4LjgzIDE5Ljk1LDExLjFMMjIsMTFBMSwxIDAgMCwxIDIzLDEyQTEsMSAwIDAsMSAyMiwxM0wxOS45NSwxMi45QzE5LjcsMTUuMTcgMTguNSwxNy4xNSAxNi43NSwxOC40NEwxNy44NywyMC4xNkMxOC4xNCwyMC42NCAxOCwyMS4yNSAxNy41LDIxLjUzQzE3LDIxLjggMTYuNDEsMjEuNjQgMTYuMTMsMjEuMTZMMTUuMiwxOS4zNEMxNC4yMiwxOS43NiAxMy4xNCwyMCAxMiwyMEMxMC44NiwyMCA5Ljc4LDE5Ljc2IDguOCwxOS4zNEw3Ljg3LDIxLjE2QzcuNTksMjEuNjQgNywyMS44IDYuNSwyMS41M0M2LDIxLjI1IDUuODYsMjAuNjQgNi4xMywyMC4xNkw3LjI1LDE4LjQ0QzUuNSwxNy4xNSA0LjMsMTUuMTcgNC4wNSwxMi45TDIsMTNBMSwxIDAgMCwxIDEsMTJBMSwxIDAgMCwxIDIsMTFNOS4wNywxMS4zNUM5LjIsMTAuNzQgOS41MywxMC4yIDEwLDkuNzlMOC4zNCw3LjI1QzcuMTEsOC4xOSA2LjI3LDkuNiA2LjA1LDExLjJMOS4wNywxMS4zNU0xMiw5QzEyLjMyLDkgMTIuNjIsOS4wNSAxMi45LDkuMTRMMTQuMjgsNi40NUMxMy41OCw2LjE2IDEyLjgxLDYgMTIsNkMxMS4xOSw2IDEwLjQyLDYuMTYgOS43Miw2LjQ1TDExLjEsOS4xNEMxMS4zOCw5LjA1IDExLjY4LDkgMTIsOU0xNC45MywxMS4zNUwxNy45NSwxMS4yQzE3LjczLDkuNiAxNi44OSw4LjE5IDE1LjY2LDcuMjVMMTQsOS43OUMxNC40NywxMC4yIDE0LjgsMTAuNzQgMTQuOTMsMTEuMzVNMTQuOTMsMTIuNjVDMTQuOCwxMy4yNiAxNC40NywxMy44IDE0LDE0LjIxTDE1LjY2LDE2Ljc1QzE2Ljg5LDE1LjgxIDE3LjczLDE0LjQgMTcuOTUsMTIuOEwxNC45MywxMi42NU0xMiwxNUMxMS42OCwxNSAxMS4zOCwxNC45NSAxMS4wOSwxNC44Nkw5LjcyLDE3LjU1QzEwLjQyLDE3Ljg0IDExLjE5LDE4IDEyLDE4QzEyLjgxLDE4IDEzLjU4LDE3Ljg0IDE0LjI4LDE3LjU1TDEyLjkxLDE0Ljg2QzEyLjYyLDE0Ljk1IDEyLjMyLDE1IDEyLDE1TTkuMDcsMTIuNjVMNi4wNSwxMi44QzYuMjcsMTQuNCA3LjExLDE1LjgxIDguMzQsMTYuNzVMMTAsMTQuMjFDOS41MywxMy44IDkuMiwxMy4yNiA5LjA3LDEyLjY1WlwiIC8+PC9zdmc+JztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9KSgpO1xuXG4gIChmdW5jdGlvbiByZXNldCgpIHtcbiAgICByZXNldEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XG4gICAgfSk7XG4gIH0pKCk7XG5cbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVHYW1lQm9hcmRzLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgZG9tO1xuIiwiaW1wb3J0IGRvbSBmcm9tIFwiLi9kb21cIjtcbmltcG9ydCBzaGlwIGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCBnYW1lQm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5pbXBvcnQgcGxheWVyIGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IGdhbWUgZnJvbSBcIi4vZ2FtZVwiO1xuXG5kb20uY3JlYXRlR2FtZUJvYXJkcygpO1xuZ2FtZTtcbiJdLCJuYW1lcyI6WyJsZW5ndGgiLCJuYW1lIiwiaGl0cyIsInN1bmsiLCJoaXQiLCJnZXRIaXRzIiwiaXNTdW5rIiwic2hpcE5hbWUiLCJib2FyZCIsIm1pc3NlZEF0dGFjayIsImF0dGFja2VkUG9zaXRpb24iLCJzaGlwUG9zaXRpb24iLCJzaGlwcyIsImluZGV4RmluZGVyIiwicG9zMSIsInBvczIiLCJjaGVja1ZhbGlkaXR5Iiwic2hpcCIsImRpcmVjdGlvbiIsImluZGV4IiwiaSIsImluY2x1ZGVzIiwiY3JlYXRlQm9hcmQiLCJqIiwibmV3Q29vcmRpbmF0ZXMiLCJjb29yZGluYXRlcyIsImNyZWF0ZUNvb3JkaW5hdGUiLCJwdXNoIiwiZ2V0Qm9hcmQiLCJwbGFjZVNoaXAiLCJyZWNlaXZlQXR0YWNrIiwiZmluZFNoaXAiLCJpc0FsbFN1bmsiLCJnZXRNaXNzZWRQb3NpdGlvbnMiLCJnZXRBdHRhY2tlZFBvc2l0aW9ucyIsImdldFNoaXBzUG9zaXRpb25zIiwicmFuZG9tQ29vcmRpbmF0ZXMiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21BdHRhY2siLCJwbGF5ZXIiLCJnZXRTaG90Q29vcmRpbmF0ZXMiLCJyYW5kb21QbGFjZW1lbnQiLCJnZXRTaGlwcyIsImdhbWVyIiwiY29tcHV0ZXIiLCJnYW1lckJvYXJkIiwiY29tcHV0ZXJCb2FyZCIsImdhbWVyU2hpcHMiLCJjb21wdXRlclNoaXBzIiwidHVybiIsIndpbm5lciIsImlucHV0Iiwic2V0SW5wdXQiLCJnYW1lTG9vcCIsImNvbnNvbGUiLCJsb2ciLCJnZXRUdXJuIiwiZ2V0V2lubmVyIiwiZ2V0R2FtZXJCb2FyZCIsImdldENvbXB1dGVyQm9hcmQiLCJnZXRHYW1lclNoaXBzIiwiZ2V0Q29tcHV0ZXJTaGlwcyIsImRpc3BsYXkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwbGF5ZXJCb2FyZERpdiIsImNvbXB1dGVyQm9hcmREaXYiLCJkaXJlY3Rpb25CdXR0b24iLCJyZXNldEJ1dHRvbiIsImdldENvb3JkaW5hdGVzIiwidGFyZ2V0IiwiY2xhc3NMaXN0Iiwic3BsaXQiLCJwYXJzZUludCIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0ZXh0Q29udGVudCIsImN1cnJlbnRTaGlwIiwiZ3JpZCIsImNvbnRhaW5zIiwidmFsdWUiLCJzaGlmdCIsInNoaXBQb3NpdGlvbnMiLCJjaGlsZHJlbiIsImFkZCIsImNlbGwiLCJyZW1vdmUiLCJnYW1lck1pc3NlZFBvcyIsImNvbXB1dGVyTWlzc2VkUG9zIiwiZ2FtZXJBdHRhY2tlZFBvcyIsImNvbXB1dGVyQXR0YWNrZWRQb3MiLCJzdmdEaXYiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJpbm5lckhUTUwiLCJsb2NhdGlvbiIsInJlbG9hZCIsImNyZWF0ZUdhbWVCb2FyZHMiXSwic291cmNlUm9vdCI6IiJ9