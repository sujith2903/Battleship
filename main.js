(()=>{"use strict";const t=function(t,e){let n=0,r=!1;return{hit:function(){return n+=1,n},getHits:function(){return n},isSunk:function(){return n==t&&(r=!0),r},length:t,shipName:e}},e=function(){let e=function(){let t=[],e=[],n=[],r=[],i=[];function o(t,e){return 10*t+e}function a(t,e,n,i){let a=o(t,e);if("Horizontal"==i)for(let t=0;t<n.length;t++)if(r.includes(a+t))return!1;if("Vertical"==i)for(let t=0;t<n.length;t++)if(r.includes(a+10*t))return!1;return!("Horizontal"==i&&e+n.length>10||"Vertical"==i&&t+n.length>10)}return{createBoard:function(){for(let e=0;e<10;e++)for(let n=0;n<10;n++){let r={coordinates:void 0,name:void 0};r.coordinates=[e,n],r.name=null,t.push(r)}return t},getBoard:function(){return t},checkValidity:a,placeShip:function(e,n,s,c){if("Horizontal"==c&&a(e,n,s,c)){let i=o(e,n);for(let e=0;e<s.length;e++)t[i+e].name=s.shipName,r.push(i+e)}if("Vertical"==c&&a(e,n,s,c)){let i=o(e,n);for(let e=0;e<s.length;e++)t[i+10*e].name=s.shipName,r.push(i+10*e)}i.push(s)},receiveAttack:function(r,a){let s=o(r,a);null!=t[s].name?n.includes(s)||(n.push(s),function(t){for(let e=0;e<i.length;e++)if(i[e].shipName==t)return i[e]}(t[s].name).hit()):e.includes(s)||e.push(s)},isAllSunk:function(){if(r.length==n.length)return!0},getMissedPositions:function(){return e},getAttackedPositions:function(){return n},getShipsPositions:function(){return r}}}(),n=[t(5,"Carrier"),t(4,"Battleship"),t(3,"Cruiser"),t(3,"Submarine"),t(2,"Destroyer")];function r(){return[Math.floor(10*Math.random()),Math.floor(10*Math.random())]}return{randomAttack:function t(e){let n=r(),i=n[0],o=n[1],a=function(t,e){return 10*t+e}(i,o);e.getShotCoordinates().includes(a)?t(e):e.receiveAttack(i,o)},randomPlacement:function t(n){let i=r(),o=i[0],a=i[1],s="";s=1==Math.floor(2*Math.random())?"Horizontal":"Vertical",e.checkValidity(o,a,n,s)?e.placeShip(o,a,n,s):t(n)},getBoard:function(){return e},getShips:function(){return n},getShotCoordinates:function(){return[...e.getAttackedPositions(),...e.getMissedPositions()]},createBoard:e.createBoard,getBoard:e.getBoard,placeShip:e.placeShip,checkValidity:e.checkValidity,receiveAttack:e.receiveAttack,isAllSunk:e.isAllSunk,getMissedPositions:e.getMissedPositions,getAttackedPositions:e.getAttackedPositions,getShipsPositions:e.getShipsPositions}},n=function(){let t=e(),n=e();t.createBoard(),n.createBoard();let r=t.getBoard(),i=n.getBoard(),o=t.getShips(),a=n.getShips(),s="Gamer",c="",l=[];return{gamer:t,computer:n,setInput:function(t){l=t},gameLoop:function(){"Gamer"==s&&(n.receiveAttack(l[0],l[1]),n.isAllSunk()?c="Gamer":(s="Computer",l=[])),"Computer"==s&&(n.randomAttack(t),t.isAllSunk()?c="Computer":s="Gamer"),console.log(c)},getTurn:function(){return s},getWinner:function(){return c},getGamerBoard:function(){return r},getComputerBoard:function(){return i},getGamerShips:function(){return o},getComputerShips:function(){return a}}}();(function(){const t=document.querySelector(".display"),e=document.querySelector(".player-board"),r=document.querySelector(".computer-board"),i=document.querySelector(".direction");let o=n.getGamerBoard(),a=n.getComputerBoard(),s=[...n.getGamerShips()],c=[...n.getComputerShips()];function l(t){let e=t.classList[1].split(",");return[parseInt(e[0]),parseInt(e[1])]}return window.addEventListener("load",(()=>{t.textContent="Welcome to Battleship. Place your Carrier"})),window.addEventListener("click",(()=>{switch(s.length){case 4:t.textContent="Place your Battleship";break;case 3:t.textContent="Place your Cruiser";break;case 2:t.textContent="Place your Submarine";break;case 1:t.textContent="Place your Destroyer";break;case 0:""==n.getWinner()?t.textContent=`${n.getTurn()}'s Turn`:t.textContent=`${n.getWinner()} Won`}})),function(){let t,r,a=s[0];e.addEventListener("click",(c=>{if(c.target.classList.contains("player-board")){let d=c.target;if(t=l(d)[0],r=l(d)[1],s.length>0&&n.gamer.checkValidity(t,r,a,i.value)){n.gamer.placeShip(t,r,a,i.value),s.shift(),a=s[0];let c=n.gamer.getShipsPositions();for(let t=0;t<c.length;t++)e.children[c[t]].classList.add("player-ship");console.log(o)}}})),e.addEventListener("mouseover",(e=>{if(e.target.classList.contains("grid")){let o=e.target;t=l(o)[0],r=l(o)[1],s.length>0&&n.gamer.checkValidity(t,r,a,i.value)?o.classList.add("green"):s.length>0&&o.classList.add("red")}})),e.addEventListener("mouseout",(t=>{if(t.target.classList.contains("grid")){(e=t.target).classList.remove("green"),e.classList.remove("red")}var e}))}(),i.addEventListener("click",(()=>{"Horizontal"==i.value?(i.value="Vertical",i.textContent="Set Horizontal"):(i.value="Horizontal",i.textContent="Set Vertical")})),function(){let t=c[0];window.addEventListener("load",(()=>{for(;c.length>0;)n.computer.randomPlacement(t),c.shift(),t=c[0];let e=n.computer.getShipsPositions();for(let t=0;t<e.length;t++)r.children[e[t]].classList.add("computer-ship")}))}(),r.addEventListener("click",(t=>{if(0==s.length&&t.target.classList.contains("computer-board")){let e=t.target,r=parseInt(e.classList[0]),i=l(e)[0],o=l(e)[1];n.computer.getShotCoordinates().includes(r)||""!=n.getWinner()||0!=s.length||(n.setInput([i,o]),n.gameLoop())}})),window.addEventListener("click",(()=>{let t=n.gamer.getMissedPositions(),i=n.computer.getMissedPositions(),o=n.gamer.getAttackedPositions(),a=n.computer.getAttackedPositions();for(let n=0;n<t.length;n++)e.children[t[n]].classList.add("missed");for(let t=0;t<i.length;t++)r.children[i[t]].classList.add("missed");for(let t=0;t<o.length;t++)e.children[o[t]].classList.add("attacked");for(let t=0;t<a.length;t++)r.children[a[t]].classList.add("attacked")})),{hideDisplay:function(t){t.classList.remove("show"),t.classList.add("hide")},showDisplay:function(t){t.classList.remove("hide"),t.classList.add("show")},createGameBoards:function(){for(let t=0;t<o.length;t++){let n=document.createElement("div");n.classList.add(t),n.classList.add(o[t].coordinates),n.classList.add("grid"),n.classList.add("player-board"),e.appendChild(n)}for(let t=0;t<a.length;t++){let e=document.createElement("div");e.classList.add(t),e.classList.add(a[t].coordinates),e.classList.add("grid"),e.classList.add("computer-board"),r.appendChild(e)}}}})().createGameBoards()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aGlwLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZG9tLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2hpcCA9IGZ1bmN0aW9uIChsZW5ndGgsIG5hbWUpIHtcbiAgbGV0IGhpdHMgPSAwO1xuICBsZXQgc3VuayA9IGZhbHNlO1xuICBsZXQgc2hpcE5hbWUgPSBuYW1lO1xuXG4gIGZ1bmN0aW9uIGhpdCgpIHtcbiAgICBoaXRzICs9IDE7XG4gICAgcmV0dXJuIGhpdHM7XG4gIH1cblxuICBmdW5jdGlvbiBpc1N1bmsoKSB7XG4gICAgaWYgKGhpdHMgPT0gbGVuZ3RoKSB7XG4gICAgICBzdW5rID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHN1bms7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRIaXRzKCkge1xuICAgIHJldHVybiBoaXRzO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBoaXQsXG4gICAgZ2V0SGl0cyxcbiAgICBpc1N1bmssXG4gICAgbGVuZ3RoLFxuICAgIHNoaXBOYW1lLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgc2hpcDtcbiIsImltcG9ydCBzaGlwIGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCBnYW1lQm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5cbmNvbnN0IHBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgbGV0IGJvYXJkID0gZ2FtZUJvYXJkKCk7XG4gIGxldCBjYXJyaWVyID0gc2hpcCg1LCBcIkNhcnJpZXJcIik7XG4gIGxldCBiYXR0bGVzaGlwID0gc2hpcCg0LCBcIkJhdHRsZXNoaXBcIik7XG4gIGxldCBjcnVpc2VyID0gc2hpcCgzLCBcIkNydWlzZXJcIik7XG4gIGxldCBzdWJtYXJpbmUgPSBzaGlwKDMsIFwiU3VibWFyaW5lXCIpO1xuICBsZXQgZGVzdHJveWVyID0gc2hpcCgyLCBcIkRlc3Ryb3llclwiKTtcbiAgbGV0IHNoaXBzID0gW2NhcnJpZXIsIGJhdHRsZXNoaXAsIGNydWlzZXIsIHN1Ym1hcmluZSwgZGVzdHJveWVyXTtcblxuICBmdW5jdGlvbiBpbmRleEZpbmRlcihwb3MxLCBwb3MyKSB7XG4gICAgbGV0IGluZGV4ID0gcG9zMSAqIDEwICsgcG9zMjtcbiAgICByZXR1cm4gaW5kZXg7XG4gIH1cblxuICBmdW5jdGlvbiByYW5kb21Db29yZGluYXRlcygpIHtcbiAgICBsZXQgeCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICBsZXQgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcblxuICAgIHJldHVybiBbeCwgeV07XG4gIH1cblxuICBmdW5jdGlvbiByYW5kb21BdHRhY2socGxheWVyKSB7XG4gICAgbGV0IGNvb3JkaW5hdGVzID0gcmFuZG9tQ29vcmRpbmF0ZXMoKTtcbiAgICBsZXQgcG9zMSA9IGNvb3JkaW5hdGVzWzBdO1xuICAgIGxldCBwb3MyID0gY29vcmRpbmF0ZXNbMV07XG5cbiAgICBsZXQgaW5kZXggPSBpbmRleEZpbmRlcihwb3MxLCBwb3MyKTtcblxuICAgIGlmIChwbGF5ZXIuZ2V0U2hvdENvb3JkaW5hdGVzKCkuaW5jbHVkZXMoaW5kZXgpKSB7XG4gICAgICByYW5kb21BdHRhY2socGxheWVyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGxheWVyLnJlY2VpdmVBdHRhY2socG9zMSwgcG9zMik7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcmFuZG9tUGxhY2VtZW50KHNoaXApIHtcbiAgICBsZXQgY29vcmRpbmF0ZXMgPSByYW5kb21Db29yZGluYXRlcygpO1xuICAgIGxldCBwb3MxID0gY29vcmRpbmF0ZXNbMF07XG4gICAgbGV0IHBvczIgPSBjb29yZGluYXRlc1sxXTtcbiAgICBsZXQgZGlyZWN0aW9uID0gXCJcIjtcblxuICAgIGxldCByYW5kb21EaXJlY3Rpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKTtcblxuICAgIGlmIChyYW5kb21EaXJlY3Rpb24gPT0gMSkge1xuICAgICAgZGlyZWN0aW9uID0gXCJIb3Jpem9udGFsXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpcmVjdGlvbiA9IFwiVmVydGljYWxcIjtcbiAgICB9XG5cbiAgICBpZiAoYm9hcmQuY2hlY2tWYWxpZGl0eShwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pKSB7XG4gICAgICBib2FyZC5wbGFjZVNoaXAocG9zMSwgcG9zMiwgc2hpcCwgZGlyZWN0aW9uKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmFuZG9tUGxhY2VtZW50KHNoaXApO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEJvYXJkKCkge1xuICAgIHJldHVybiBib2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFNoaXBzKCkge1xuICAgIHJldHVybiBzaGlwcztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFNob3RDb29yZGluYXRlcygpIHtcbiAgICBsZXQgYXR0YWNrZWQgPSBib2FyZC5nZXRBdHRhY2tlZFBvc2l0aW9ucygpO1xuICAgIGxldCBtaXNzZWQgPSBib2FyZC5nZXRNaXNzZWRQb3NpdGlvbnMoKTtcbiAgICBsZXQgc2hvdENvb3JkaW5hdGVzID0gWy4uLmF0dGFja2VkLCAuLi5taXNzZWRdO1xuICAgIHJldHVybiBzaG90Q29vcmRpbmF0ZXM7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHJhbmRvbUF0dGFjayxcbiAgICByYW5kb21QbGFjZW1lbnQsXG4gICAgZ2V0Qm9hcmQsXG4gICAgZ2V0U2hpcHMsXG4gICAgZ2V0U2hvdENvb3JkaW5hdGVzLFxuICAgIGNyZWF0ZUJvYXJkOiBib2FyZC5jcmVhdGVCb2FyZCxcbiAgICBnZXRCb2FyZDogYm9hcmQuZ2V0Qm9hcmQsXG4gICAgcGxhY2VTaGlwOiBib2FyZC5wbGFjZVNoaXAsXG4gICAgY2hlY2tWYWxpZGl0eTogYm9hcmQuY2hlY2tWYWxpZGl0eSxcbiAgICByZWNlaXZlQXR0YWNrOiBib2FyZC5yZWNlaXZlQXR0YWNrLFxuICAgIGlzQWxsU3VuazogYm9hcmQuaXNBbGxTdW5rLFxuICAgIGdldE1pc3NlZFBvc2l0aW9uczogYm9hcmQuZ2V0TWlzc2VkUG9zaXRpb25zLFxuICAgIGdldEF0dGFja2VkUG9zaXRpb25zOiBib2FyZC5nZXRBdHRhY2tlZFBvc2l0aW9ucyxcbiAgICBnZXRTaGlwc1Bvc2l0aW9uczogYm9hcmQuZ2V0U2hpcHNQb3NpdGlvbnMsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBwbGF5ZXI7XG4iLCJpbXBvcnQgc2hpcCBmcm9tIFwiLi9zaGlwXCI7XG5jb25zdCBnYW1lQm9hcmQgPSBmdW5jdGlvbiAoKSB7XG4gIGxldCBib2FyZCA9IFtdO1xuICBsZXQgbWlzc2VkQXR0YWNrID0gW107XG4gIGxldCBhdHRhY2tlZFBvc2l0aW9uID0gW107XG4gIGxldCBzaGlwUG9zaXRpb24gPSBbXTtcbiAgbGV0IHNoaXBzID0gW107XG5cbiAgZnVuY3Rpb24gY3JlYXRlQ29vcmRpbmF0ZShjb29yZGluYXRlcywgbmFtZSkge1xuICAgIHJldHVybiB7IGNvb3JkaW5hdGVzLCBuYW1lIH07XG4gIH1cblxuICBmdW5jdGlvbiBpbmRleEZpbmRlcihwb3MxLCBwb3MyKSB7XG4gICAgbGV0IGluZGV4ID0gcG9zMSAqIDEwICsgcG9zMjtcbiAgICByZXR1cm4gaW5kZXg7XG4gIH1cblxuICBmdW5jdGlvbiBjcmVhdGVCb2FyZCgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICBsZXQgbmV3Q29vcmRpbmF0ZXMgPSBjcmVhdGVDb29yZGluYXRlKCk7XG4gICAgICAgIG5ld0Nvb3JkaW5hdGVzLmNvb3JkaW5hdGVzID0gW2ksIGpdO1xuICAgICAgICBuZXdDb29yZGluYXRlcy5uYW1lID0gbnVsbDtcbiAgICAgICAgYm9hcmQucHVzaChuZXdDb29yZGluYXRlcyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBib2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNoZWNrVmFsaWRpdHkocG9zMSwgcG9zMiwgc2hpcCwgZGlyZWN0aW9uKSB7XG4gICAgbGV0IGluZGV4ID0gaW5kZXhGaW5kZXIocG9zMSwgcG9zMik7XG5cbiAgICBpZiAoZGlyZWN0aW9uID09IFwiSG9yaXpvbnRhbFwiKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXAubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHNoaXBQb3NpdGlvbi5pbmNsdWRlcyhpbmRleCArIGkpKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGRpcmVjdGlvbiA9PSBcIlZlcnRpY2FsXCIpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoc2hpcFBvc2l0aW9uLmluY2x1ZGVzKGluZGV4ICsgaSAqIDEwKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJIb3Jpem9udGFsXCIgJiYgcG9zMiArIHNoaXAubGVuZ3RoID4gMTApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBpZiAoZGlyZWN0aW9uID09IFwiVmVydGljYWxcIiAmJiBwb3MxICsgc2hpcC5sZW5ndGggPiAxMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYWNlU2hpcChwb3MxLCBwb3MyLCBzaGlwLCBkaXJlY3Rpb24pIHtcbiAgICBpZiAoXG4gICAgICBkaXJlY3Rpb24gPT0gXCJIb3Jpem9udGFsXCIgJiZcbiAgICAgIGNoZWNrVmFsaWRpdHkocG9zMSwgcG9zMiwgc2hpcCwgZGlyZWN0aW9uKVxuICAgICkge1xuICAgICAgbGV0IGluZGV4ID0gaW5kZXhGaW5kZXIocG9zMSwgcG9zMik7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBib2FyZFtpbmRleCArIGldLm5hbWUgPSBzaGlwLnNoaXBOYW1lO1xuICAgICAgICBzaGlwUG9zaXRpb24ucHVzaChpbmRleCArIGkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChkaXJlY3Rpb24gPT0gXCJWZXJ0aWNhbFwiICYmIGNoZWNrVmFsaWRpdHkocG9zMSwgcG9zMiwgc2hpcCwgZGlyZWN0aW9uKSkge1xuICAgICAgbGV0IGluZGV4ID0gaW5kZXhGaW5kZXIocG9zMSwgcG9zMik7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcC5sZW5ndGg7IGkrKykge1xuICAgICAgICBib2FyZFtpbmRleCArIGkgKiAxMF0ubmFtZSA9IHNoaXAuc2hpcE5hbWU7XG4gICAgICAgIHNoaXBQb3NpdGlvbi5wdXNoKGluZGV4ICsgaSAqIDEwKTtcbiAgICAgIH1cbiAgICB9XG4gICAgc2hpcHMucHVzaChzaGlwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlY2VpdmVBdHRhY2socG9zMSwgcG9zMikge1xuICAgIGxldCBpbmRleCA9IGluZGV4RmluZGVyKHBvczEsIHBvczIpO1xuXG4gICAgaWYgKGJvYXJkW2luZGV4XS5uYW1lICE9IG51bGwpIHtcbiAgICAgIGlmICghYXR0YWNrZWRQb3NpdGlvbi5pbmNsdWRlcyhpbmRleCkpIHtcbiAgICAgICAgYXR0YWNrZWRQb3NpdGlvbi5wdXNoKGluZGV4KTtcbiAgICAgICAgZmluZFNoaXAoYm9hcmRbaW5kZXhdLm5hbWUpLmhpdCgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIW1pc3NlZEF0dGFjay5pbmNsdWRlcyhpbmRleCkpIHtcbiAgICAgICAgbWlzc2VkQXR0YWNrLnB1c2goaW5kZXgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbmRTaGlwKG5hbWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoc2hpcHNbaV0uc2hpcE5hbWUgPT0gbmFtZSkge1xuICAgICAgICByZXR1cm4gc2hpcHNbaV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaXNBbGxTdW5rKCkge1xuICAgIGlmIChzaGlwUG9zaXRpb24ubGVuZ3RoID09IGF0dGFja2VkUG9zaXRpb24ubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBnZXRCb2FyZCgpIHtcbiAgICByZXR1cm4gYm9hcmQ7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRNaXNzZWRQb3NpdGlvbnMoKSB7XG4gICAgcmV0dXJuIG1pc3NlZEF0dGFjaztcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldFNoaXBzUG9zaXRpb25zKCkge1xuICAgIHJldHVybiBzaGlwUG9zaXRpb247XG4gIH1cblxuICBmdW5jdGlvbiBnZXRBdHRhY2tlZFBvc2l0aW9ucygpIHtcbiAgICByZXR1cm4gYXR0YWNrZWRQb3NpdGlvbjtcbiAgfVxuICByZXR1cm4ge1xuICAgIGNyZWF0ZUJvYXJkLFxuICAgIGdldEJvYXJkLFxuICAgIGNoZWNrVmFsaWRpdHksXG4gICAgcGxhY2VTaGlwLFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgaXNBbGxTdW5rLFxuICAgIGdldE1pc3NlZFBvc2l0aW9ucyxcbiAgICBnZXRBdHRhY2tlZFBvc2l0aW9ucyxcbiAgICBnZXRTaGlwc1Bvc2l0aW9ucyxcbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGdhbWVCb2FyZDtcbiIsImltcG9ydCBzaGlwIGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCBnYW1lQm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5pbXBvcnQgcGxheWVyIGZyb20gXCIuL3BsYXllclwiO1xuXG5jb25zdCBnYW1lID0gKGZ1bmN0aW9uICgpIHtcbiAgbGV0IGdhbWVyID0gcGxheWVyKCk7XG4gIGxldCBjb21wdXRlciA9IHBsYXllcigpO1xuXG4gIGdhbWVyLmNyZWF0ZUJvYXJkKCk7XG4gIGNvbXB1dGVyLmNyZWF0ZUJvYXJkKCk7XG5cbiAgbGV0IGdhbWVyQm9hcmQgPSBnYW1lci5nZXRCb2FyZCgpO1xuICBsZXQgY29tcHV0ZXJCb2FyZCA9IGNvbXB1dGVyLmdldEJvYXJkKCk7XG4gIGxldCBnYW1lclNoaXBzID0gZ2FtZXIuZ2V0U2hpcHMoKTtcbiAgbGV0IGNvbXB1dGVyU2hpcHMgPSBjb21wdXRlci5nZXRTaGlwcygpO1xuXG4gIGxldCB0dXJuID0gXCJHYW1lclwiO1xuICBsZXQgd2lubmVyID0gXCJcIjtcbiAgbGV0IGlucHV0ID0gW107XG5cbiAgZnVuY3Rpb24gZ2FtZUxvb3AoKSB7XG4gICAgaWYgKHR1cm4gPT0gXCJHYW1lclwiKSB7XG4gICAgICBjb21wdXRlci5yZWNlaXZlQXR0YWNrKGlucHV0WzBdLCBpbnB1dFsxXSk7XG4gICAgICBpZiAoY29tcHV0ZXIuaXNBbGxTdW5rKCkpIHtcbiAgICAgICAgd2lubmVyID0gXCJHYW1lclwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHVybiA9IFwiQ29tcHV0ZXJcIjtcbiAgICAgICAgaW5wdXQgPSBbXTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHR1cm4gPT0gXCJDb21wdXRlclwiKSB7XG4gICAgICBjb21wdXRlci5yYW5kb21BdHRhY2soZ2FtZXIpO1xuICAgICAgaWYgKGdhbWVyLmlzQWxsU3VuaygpKSB7XG4gICAgICAgIHdpbm5lciA9IFwiQ29tcHV0ZXJcIjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHR1cm4gPSBcIkdhbWVyXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKHdpbm5lcik7XG4gIH1cblxuICBmdW5jdGlvbiBzZXRJbnB1dChjb29yZGluYXRlcykge1xuICAgIGlucHV0ID0gY29vcmRpbmF0ZXM7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRUdXJuKCkge1xuICAgIHJldHVybiB0dXJuO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0V2lubmVyKCkge1xuICAgIHJldHVybiB3aW5uZXI7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRHYW1lckJvYXJkKCkge1xuICAgIHJldHVybiBnYW1lckJvYXJkO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Q29tcHV0ZXJCb2FyZCgpIHtcbiAgICByZXR1cm4gY29tcHV0ZXJCb2FyZDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEdhbWVyU2hpcHMoKSB7XG4gICAgcmV0dXJuIGdhbWVyU2hpcHM7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRDb21wdXRlclNoaXBzKCkge1xuICAgIHJldHVybiBjb21wdXRlclNoaXBzO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBnYW1lcixcbiAgICBjb21wdXRlcixcbiAgICBzZXRJbnB1dCxcbiAgICBnYW1lTG9vcCxcbiAgICBnZXRUdXJuLFxuICAgIGdldFdpbm5lcixcbiAgICBnZXRHYW1lckJvYXJkLFxuICAgIGdldENvbXB1dGVyQm9hcmQsXG4gICAgZ2V0R2FtZXJTaGlwcyxcbiAgICBnZXRDb21wdXRlclNoaXBzLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgZ2FtZTtcbiIsImltcG9ydCBzaGlwIGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCBnYW1lQm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5pbXBvcnQgcGxheWVyIGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IGdhbWUgZnJvbSBcIi4vZ2FtZVwiO1xuXG5jb25zdCBkb20gPSAoZnVuY3Rpb24gKCkge1xuICBjb25zdCBkaXNwbGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaXNwbGF5XCIpO1xuICBjb25zdCBwbGF5ZXJCb2FyZERpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLWJvYXJkXCIpO1xuICBjb25zdCBjb21wdXRlckJvYXJkRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wdXRlci1ib2FyZFwiKTtcbiAgY29uc3QgZGlyZWN0aW9uQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaXJlY3Rpb25cIik7XG5cbiAgbGV0IGdhbWVyQm9hcmQgPSBnYW1lLmdldEdhbWVyQm9hcmQoKTtcbiAgbGV0IGNvbXB1dGVyQm9hcmQgPSBnYW1lLmdldENvbXB1dGVyQm9hcmQoKTtcbiAgbGV0IGdhbWVyU2hpcHMgPSBbLi4uZ2FtZS5nZXRHYW1lclNoaXBzKCldO1xuICBsZXQgY29tcHV0ZXJTaGlwcyA9IFsuLi5nYW1lLmdldENvbXB1dGVyU2hpcHMoKV07XG5cbiAgZnVuY3Rpb24gaGlkZURpc3BsYXkoZWxlbWVudCkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInNob3dcIik7XG4gICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaGlkZVwiKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNob3dEaXNwbGF5KGVsZW1lbnQpIHtcbiAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInNob3dcIik7XG4gIH1cblxuICBmdW5jdGlvbiBjcmVhdGVHYW1lQm9hcmRzKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ2FtZXJCb2FyZC5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IGdyaWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKGkpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKGdhbWVyQm9hcmRbaV0uY29vcmRpbmF0ZXMpO1xuICAgICAgZ3JpZC5jbGFzc0xpc3QuYWRkKFwiZ3JpZFwiKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChcInBsYXllci1ib2FyZFwiKTtcbiAgICAgIHBsYXllckJvYXJkRGl2LmFwcGVuZENoaWxkKGdyaWQpO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbXB1dGVyQm9hcmQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBncmlkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChpKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChjb21wdXRlckJvYXJkW2ldLmNvb3JkaW5hdGVzKTtcbiAgICAgIGdyaWQuY2xhc3NMaXN0LmFkZChcImdyaWRcIik7XG4gICAgICBncmlkLmNsYXNzTGlzdC5hZGQoXCJjb21wdXRlci1ib2FyZFwiKTtcbiAgICAgIGNvbXB1dGVyQm9hcmREaXYuYXBwZW5kQ2hpbGQoZ3JpZCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Q29vcmRpbmF0ZXModGFyZ2V0KSB7XG4gICAgbGV0IGNvb3JkaW5hdGVzID0gdGFyZ2V0LmNsYXNzTGlzdFsxXS5zcGxpdChcIixcIik7XG4gICAgbGV0IHBvczEgPSBwYXJzZUludChjb29yZGluYXRlc1swXSk7XG4gICAgbGV0IHBvczIgPSBwYXJzZUludChjb29yZGluYXRlc1sxXSk7XG5cbiAgICByZXR1cm4gW3BvczEsIHBvczJdO1xuICB9XG5cbiAgZnVuY3Rpb24gYWRkVmFsaWRpdHlDb2xvcihjZWxsKSB7XG4gICAgY2VsbC5jbGFzc0xpc3QuYWRkKFwiZ3JlZW5cIik7XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVWYWxpZGl0eUNvbG9yKGNlbGwpIHtcbiAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoXCJncmVlblwiKTtcbiAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoXCJyZWRcIik7XG4gIH1cblxuICBmdW5jdGlvbiBhZGROb25WYWxpZGl0eUNvbG9yKGNlbGwpIHtcbiAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJyZWRcIik7XG4gIH1cblxuICAoZnVuY3Rpb24gZGlzcGxheUV2ZW50cygpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgKCkgPT4ge1xuICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IFwiV2VsY29tZSB0byBCYXR0bGVzaGlwLiBQbGFjZSB5b3VyIENhcnJpZXJcIjtcbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgc3dpdGNoIChnYW1lclNoaXBzLmxlbmd0aCkge1xuICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgZGlzcGxheS50ZXh0Q29udGVudCA9IFwiUGxhY2UgeW91ciBCYXR0bGVzaGlwXCI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICBkaXNwbGF5LnRleHRDb250ZW50ID0gXCJQbGFjZSB5b3VyIENydWlzZXJcIjtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBcIlBsYWNlIHlvdXIgU3VibWFyaW5lXCI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICBkaXNwbGF5LnRleHRDb250ZW50ID0gXCJQbGFjZSB5b3VyIERlc3Ryb3llclwiO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICBpZiAoZ2FtZS5nZXRXaW5uZXIoKSA9PSBcIlwiKSB7XG4gICAgICAgICAgICBkaXNwbGF5LnRleHRDb250ZW50ID0gYCR7Z2FtZS5nZXRUdXJuKCl9J3MgVHVybmA7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRpc3BsYXkudGV4dENvbnRlbnQgPSBgJHtnYW1lLmdldFdpbm5lcigpfSBXb25gO1xuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSkoKTtcblxuICAoZnVuY3Rpb24gcGxheWVyQm9hcmRFdmVudHMoKSB7XG4gICAgbGV0IGN1cnJlbnRTaGlwID0gZ2FtZXJTaGlwc1swXTtcbiAgICBsZXQgcG9zMTtcbiAgICBsZXQgcG9zMjtcblxuICAgIHBsYXllckJvYXJkRGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZ3JpZCkgPT4ge1xuICAgICAgaWYgKGdyaWQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBsYXllci1ib2FyZFwiKSkge1xuICAgICAgICBsZXQgdGFyZ2V0ID0gZ3JpZC50YXJnZXQ7XG4gICAgICAgIHBvczEgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzBdO1xuICAgICAgICBwb3MyID0gZ2V0Q29vcmRpbmF0ZXModGFyZ2V0KVsxXTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGdhbWVyU2hpcHMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgIGdhbWUuZ2FtZXIuY2hlY2tWYWxpZGl0eShcbiAgICAgICAgICAgIHBvczEsXG4gICAgICAgICAgICBwb3MyLFxuICAgICAgICAgICAgY3VycmVudFNoaXAsXG4gICAgICAgICAgICBkaXJlY3Rpb25CdXR0b24udmFsdWVcbiAgICAgICAgICApXG4gICAgICAgICkge1xuICAgICAgICAgIGdhbWUuZ2FtZXIucGxhY2VTaGlwKHBvczEsIHBvczIsIGN1cnJlbnRTaGlwLCBkaXJlY3Rpb25CdXR0b24udmFsdWUpO1xuICAgICAgICAgIGdhbWVyU2hpcHMuc2hpZnQoKTtcbiAgICAgICAgICBjdXJyZW50U2hpcCA9IGdhbWVyU2hpcHNbMF07XG4gICAgICAgICAgbGV0IHNoaXBQb3NpdGlvbnMgPSBnYW1lLmdhbWVyLmdldFNoaXBzUG9zaXRpb25zKCk7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwUG9zaXRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBwbGF5ZXJCb2FyZERpdi5jaGlsZHJlbltzaGlwUG9zaXRpb25zW2ldXS5jbGFzc0xpc3QuYWRkKFxuICAgICAgICAgICAgICBcInBsYXllci1zaGlwXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnNvbGUubG9nKGdhbWVyQm9hcmQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBwbGF5ZXJCb2FyZERpdi5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIChncmlkKSA9PiB7XG4gICAgICBpZiAoZ3JpZC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZ3JpZFwiKSkge1xuICAgICAgICBsZXQgdGFyZ2V0ID0gZ3JpZC50YXJnZXQ7XG4gICAgICAgIHBvczEgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzBdO1xuICAgICAgICBwb3MyID0gZ2V0Q29vcmRpbmF0ZXModGFyZ2V0KVsxXTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGdhbWVyU2hpcHMubGVuZ3RoID4gMCAmJlxuICAgICAgICAgIGdhbWUuZ2FtZXIuY2hlY2tWYWxpZGl0eShcbiAgICAgICAgICAgIHBvczEsXG4gICAgICAgICAgICBwb3MyLFxuICAgICAgICAgICAgY3VycmVudFNoaXAsXG4gICAgICAgICAgICBkaXJlY3Rpb25CdXR0b24udmFsdWVcbiAgICAgICAgICApXG4gICAgICAgICkge1xuICAgICAgICAgIGFkZFZhbGlkaXR5Q29sb3IodGFyZ2V0KTtcbiAgICAgICAgfSBlbHNlIGlmIChnYW1lclNoaXBzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBhZGROb25WYWxpZGl0eUNvbG9yKHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHBsYXllckJvYXJkRGl2LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCAoZ3JpZCkgPT4ge1xuICAgICAgaWYgKGdyaWQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImdyaWRcIikpIHtcbiAgICAgICAgbGV0IHRhcmdldCA9IGdyaWQudGFyZ2V0O1xuICAgICAgICByZW1vdmVWYWxpZGl0eUNvbG9yKHRhcmdldCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pKCk7XG5cbiAgZGlyZWN0aW9uQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgaWYgKGRpcmVjdGlvbkJ1dHRvbi52YWx1ZSA9PSBcIkhvcml6b250YWxcIikge1xuICAgICAgZGlyZWN0aW9uQnV0dG9uLnZhbHVlID0gXCJWZXJ0aWNhbFwiO1xuICAgICAgZGlyZWN0aW9uQnV0dG9uLnRleHRDb250ZW50ID0gXCJTZXQgSG9yaXpvbnRhbFwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXJlY3Rpb25CdXR0b24udmFsdWUgPSBcIkhvcml6b250YWxcIjtcbiAgICAgIGRpcmVjdGlvbkJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2V0IFZlcnRpY2FsXCI7XG4gICAgfVxuICB9KTtcblxuICAoZnVuY3Rpb24gY29tcHV0ZXJCb2FyZEV2ZW50cygpIHtcbiAgICBsZXQgY3VycmVudFNoaXAgPSBjb21wdXRlclNoaXBzWzBdO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCAoKSA9PiB7XG4gICAgICB3aGlsZSAoY29tcHV0ZXJTaGlwcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGdhbWUuY29tcHV0ZXIucmFuZG9tUGxhY2VtZW50KGN1cnJlbnRTaGlwKTtcbiAgICAgICAgY29tcHV0ZXJTaGlwcy5zaGlmdCgpO1xuICAgICAgICBjdXJyZW50U2hpcCA9IGNvbXB1dGVyU2hpcHNbMF07XG4gICAgICB9XG4gICAgICBsZXQgc2hpcFBvc2l0aW9ucyA9IGdhbWUuY29tcHV0ZXIuZ2V0U2hpcHNQb3NpdGlvbnMoKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcFBvc2l0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW3NoaXBQb3NpdGlvbnNbaV1dLmNsYXNzTGlzdC5hZGQoXG4gICAgICAgICAgXCJjb21wdXRlci1zaGlwXCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSkoKTtcblxuICAoZnVuY3Rpb24gZ2FtZUxvb3BFdmVudHMoKSB7XG4gICAgY29tcHV0ZXJCb2FyZERpdi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGdyaWQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZ2FtZXJTaGlwcy5sZW5ndGggPT0gMCAmJlxuICAgICAgICBncmlkLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjb21wdXRlci1ib2FyZFwiKVxuICAgICAgKSB7XG4gICAgICAgIGxldCB0YXJnZXQgPSBncmlkLnRhcmdldDtcbiAgICAgICAgbGV0IGluZGV4ID0gcGFyc2VJbnQodGFyZ2V0LmNsYXNzTGlzdFswXSk7XG4gICAgICAgIGxldCBwb3MxID0gZ2V0Q29vcmRpbmF0ZXModGFyZ2V0KVswXTtcbiAgICAgICAgbGV0IHBvczIgPSBnZXRDb29yZGluYXRlcyh0YXJnZXQpWzFdO1xuXG4gICAgICAgIGlmIChcbiAgICAgICAgICAhZ2FtZS5jb21wdXRlci5nZXRTaG90Q29vcmRpbmF0ZXMoKS5pbmNsdWRlcyhpbmRleCkgJiZcbiAgICAgICAgICBnYW1lLmdldFdpbm5lcigpID09IFwiXCIgJiZcbiAgICAgICAgICBnYW1lclNoaXBzLmxlbmd0aCA9PSAwXG4gICAgICAgICkge1xuICAgICAgICAgIGdhbWUuc2V0SW5wdXQoW3BvczEsIHBvczJdKTtcbiAgICAgICAgICBnYW1lLmdhbWVMb29wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgbGV0IGdhbWVyTWlzc2VkUG9zID0gZ2FtZS5nYW1lci5nZXRNaXNzZWRQb3NpdGlvbnMoKTtcbiAgICAgIGxldCBjb21wdXRlck1pc3NlZFBvcyA9IGdhbWUuY29tcHV0ZXIuZ2V0TWlzc2VkUG9zaXRpb25zKCk7XG4gICAgICBsZXQgZ2FtZXJBdHRhY2tlZFBvcyA9IGdhbWUuZ2FtZXIuZ2V0QXR0YWNrZWRQb3NpdGlvbnMoKTtcbiAgICAgIGxldCBjb21wdXRlckF0dGFja2VkUG9zID0gZ2FtZS5jb21wdXRlci5nZXRBdHRhY2tlZFBvc2l0aW9ucygpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdhbWVyTWlzc2VkUG9zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW2dhbWVyTWlzc2VkUG9zW2ldXS5jbGFzc0xpc3QuYWRkKFwibWlzc2VkXCIpO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb21wdXRlck1pc3NlZFBvcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW2NvbXB1dGVyTWlzc2VkUG9zW2ldXS5jbGFzc0xpc3QuYWRkKFwibWlzc2VkXCIpO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBnYW1lckF0dGFja2VkUG9zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBsYXllckJvYXJkRGl2LmNoaWxkcmVuW2dhbWVyQXR0YWNrZWRQb3NbaV1dLmNsYXNzTGlzdC5hZGQoXCJhdHRhY2tlZFwiKTtcbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29tcHV0ZXJBdHRhY2tlZFBvcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb21wdXRlckJvYXJkRGl2LmNoaWxkcmVuW2NvbXB1dGVyQXR0YWNrZWRQb3NbaV1dLmNsYXNzTGlzdC5hZGQoXG4gICAgICAgICAgXCJhdHRhY2tlZFwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pKCk7XG5cbiAgcmV0dXJuIHtcbiAgICBoaWRlRGlzcGxheSxcbiAgICBzaG93RGlzcGxheSxcbiAgICBjcmVhdGVHYW1lQm9hcmRzLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgZG9tO1xuIiwiaW1wb3J0IGRvbSBmcm9tIFwiLi9kb21cIjtcbmltcG9ydCBzaGlwIGZyb20gXCIuL3NoaXBcIjtcbmltcG9ydCBnYW1lQm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5pbXBvcnQgcGxheWVyIGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IGdhbWUgZnJvbSBcIi4vZ2FtZVwiO1xuXG5kb20uY3JlYXRlR2FtZUJvYXJkcygpO1xuZ2FtZTtcbiJdLCJuYW1lcyI6WyJsZW5ndGgiLCJuYW1lIiwiaGl0cyIsInN1bmsiLCJoaXQiLCJnZXRIaXRzIiwiaXNTdW5rIiwic2hpcE5hbWUiLCJib2FyZCIsIm1pc3NlZEF0dGFjayIsImF0dGFja2VkUG9zaXRpb24iLCJzaGlwUG9zaXRpb24iLCJzaGlwcyIsImluZGV4RmluZGVyIiwicG9zMSIsInBvczIiLCJjaGVja1ZhbGlkaXR5Iiwic2hpcCIsImRpcmVjdGlvbiIsImluZGV4IiwiaSIsImluY2x1ZGVzIiwiY3JlYXRlQm9hcmQiLCJqIiwibmV3Q29vcmRpbmF0ZXMiLCJjb29yZGluYXRlcyIsImNyZWF0ZUNvb3JkaW5hdGUiLCJwdXNoIiwiZ2V0Qm9hcmQiLCJwbGFjZVNoaXAiLCJyZWNlaXZlQXR0YWNrIiwiZmluZFNoaXAiLCJpc0FsbFN1bmsiLCJnZXRNaXNzZWRQb3NpdGlvbnMiLCJnZXRBdHRhY2tlZFBvc2l0aW9ucyIsImdldFNoaXBzUG9zaXRpb25zIiwicmFuZG9tQ29vcmRpbmF0ZXMiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21BdHRhY2siLCJwbGF5ZXIiLCJnZXRTaG90Q29vcmRpbmF0ZXMiLCJyYW5kb21QbGFjZW1lbnQiLCJnZXRTaGlwcyIsImdhbWVyIiwiY29tcHV0ZXIiLCJnYW1lckJvYXJkIiwiY29tcHV0ZXJCb2FyZCIsImdhbWVyU2hpcHMiLCJjb21wdXRlclNoaXBzIiwidHVybiIsIndpbm5lciIsImlucHV0Iiwic2V0SW5wdXQiLCJnYW1lTG9vcCIsImNvbnNvbGUiLCJsb2ciLCJnZXRUdXJuIiwiZ2V0V2lubmVyIiwiZ2V0R2FtZXJCb2FyZCIsImdldENvbXB1dGVyQm9hcmQiLCJnZXRHYW1lclNoaXBzIiwiZ2V0Q29tcHV0ZXJTaGlwcyIsImRpc3BsYXkiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwbGF5ZXJCb2FyZERpdiIsImNvbXB1dGVyQm9hcmREaXYiLCJkaXJlY3Rpb25CdXR0b24iLCJnZXRDb29yZGluYXRlcyIsInRhcmdldCIsImNsYXNzTGlzdCIsInNwbGl0IiwicGFyc2VJbnQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwidGV4dENvbnRlbnQiLCJjdXJyZW50U2hpcCIsImdyaWQiLCJjb250YWlucyIsInZhbHVlIiwic2hpZnQiLCJzaGlwUG9zaXRpb25zIiwiY2hpbGRyZW4iLCJhZGQiLCJjZWxsIiwicmVtb3ZlIiwiZ2FtZXJNaXNzZWRQb3MiLCJjb21wdXRlck1pc3NlZFBvcyIsImdhbWVyQXR0YWNrZWRQb3MiLCJjb21wdXRlckF0dGFja2VkUG9zIiwiaGlkZURpc3BsYXkiLCJlbGVtZW50Iiwic2hvd0Rpc3BsYXkiLCJjcmVhdGVHYW1lQm9hcmRzIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIl0sInNvdXJjZVJvb3QiOiIifQ==